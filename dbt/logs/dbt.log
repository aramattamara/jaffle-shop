[0m19:50:43.973306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d22a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d23190>]}


============================== 19:50:43.976255 | bf4614c7-6aca-4011-9b99-f457e63b9184 ==============================
[0m19:50:43.976255 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:50:43.976684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:43.984147 [info ] [MainThread]: dbt version: 1.9.0
[0m19:50:43.984431 [info ] [MainThread]: python version: 3.10.4
[0m19:50:43.984635 [info ] [MainThread]: python path: /Users/tamara/.pyenv/versions/3.10.4/envs/dbt/bin/python
[0m19:50:43.984826 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m19:50:44.568993 [info ] [MainThread]: Using profiles dir at /Users/tamara/.dbt
[0m19:50:44.569344 [info ] [MainThread]: Using profiles.yml file at /Users/tamara/.dbt/profiles.yml
[0m19:50:44.569541 [info ] [MainThread]: Using dbt_project.yml file at /Users/tamara/src/jaffle-shop/dbt/dbt_project.yml
[0m19:50:44.569733 [info ] [MainThread]: adapter type: bigquery
[0m19:50:44.569916 [info ] [MainThread]: adapter version: 1.9.0
[0m19:50:44.674583 [info ] [MainThread]: Configuration:
[0m19:50:44.675112 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:50:44.675319 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:50:44.675502 [info ] [MainThread]: Required dependencies:
[0m19:50:44.675748 [debug] [MainThread]: Executing "git --help"
[0m19:50:44.690373 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:50:44.691017 [debug] [MainThread]: STDERR: "b''"
[0m19:50:44.691265 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:50:44.691474 [info ] [MainThread]: Connection:
[0m19:50:44.691730 [info ] [MainThread]:   method: oauth
[0m19:50:44.691917 [info ] [MainThread]:   database: uku-project-437620
[0m19:50:44.692092 [info ] [MainThread]:   execution_project: uku-project-437620
[0m19:50:44.692268 [info ] [MainThread]:   schema: ds1
[0m19:50:44.692441 [info ] [MainThread]:   location: None
[0m19:50:44.692612 [info ] [MainThread]:   priority: None
[0m19:50:44.692781 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:50:44.692951 [info ] [MainThread]:   impersonate_service_account: None
[0m19:50:44.693121 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:50:44.693292 [info ] [MainThread]:   job_retries: 1
[0m19:50:44.693460 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:50:44.693636 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m19:50:44.693808 [info ] [MainThread]:   timeout_seconds: None
[0m19:50:44.693976 [info ] [MainThread]:   client_id: None
[0m19:50:44.694147 [info ] [MainThread]:   token_uri: None
[0m19:50:44.694314 [info ] [MainThread]:   dataproc_region: None
[0m19:50:44.694482 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:50:44.694650 [info ] [MainThread]:   gcs_bucket: None
[0m19:50:44.694815 [info ] [MainThread]:   dataproc_batch: None
[0m19:50:44.695230 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m19:50:44.791770 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:50:44.792180 [debug] [MainThread]: On debug: select 1 as id
[0m19:50:44.792403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:45.817181 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:1f6bf629-00a5-44a2-abf5-72e1c7ba7ca5&page=queryresults
[0m19:50:46.430029 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:50:46.431137 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:50:46.435992 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.5095732, "process_in_blocks": "0", "process_kernel_time": 0.271588, "process_mem_max_rss": "190021632", "process_out_blocks": "0", "process_user_time": 1.206793}
[0m19:50:46.437009 [debug] [MainThread]: Command `dbt debug` succeeded at 19:50:46.436849 after 2.51 seconds
[0m19:50:46.437602 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:50:46.438240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb88340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb9090>]}
[0m19:50:46.438877 [debug] [MainThread]: Flushing usage events
[0m19:50:46.781945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:25.938011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be3280>]}


============================== 19:51:25.941002 | d8d8b1d9-523d-4af1-b401-9b568a7d3a6a ==============================
[0m19:51:25.941002 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:51:25.941383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:51:26.461321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d8b1d9-523d-4af1-b401-9b568a7d3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9288e0>]}
[0m19:51:26.534934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d8b1d9-523d-4af1-b401-9b568a7d3a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a928460>]}
[0m19:51:26.535463 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m19:51:26.634352 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:51:26.636028 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.74246687, "process_in_blocks": "0", "process_kernel_time": 0.203464, "process_mem_max_rss": "184238080", "process_out_blocks": "0", "process_user_time": 1.180869}
[0m19:51:26.636429 [debug] [MainThread]: Command `dbt seed` failed at 19:51:26.636369 after 0.74 seconds
[0m19:51:26.636731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a51000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a500d0>]}
[0m19:51:26.636987 [debug] [MainThread]: Flushing usage events
[0m19:51:26.977588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:36.114529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044829e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104483100>]}


============================== 19:51:36.116900 | 8a7e1bfc-56c5-4e62-9312-ae498f896e26 ==============================
[0m19:51:36.116900 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:51:36.117256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:36.187562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a7e1bfc-56c5-4e62-9312-ae498f896e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104556d10>]}
[0m19:51:36.202574 [debug] [MainThread]: Set downloads directory='/var/folders/c3/3qjz1ly90w7__5fy0djkmt5r0000gn/T/dbt-downloads-7isowmi3'
[0m19:51:36.202853 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:51:36.262093 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:51:36.262747 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:51:36.295271 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:51:36.299118 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m19:51:36.342909 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m19:51:36.346073 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:51:36.553846 [info ] [MainThread]: Installed from version 1.1.1
[0m19:51:36.554238 [info ] [MainThread]: Updated version available: 1.3.0
[0m19:51:36.554552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a7e1bfc-56c5-4e62-9312-ae498f896e26', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469bdf0>]}
[0m19:51:36.554893 [info ] [MainThread]: Installing calogica/dbt_date
[0m19:51:36.668304 [info ] [MainThread]: Installed from version 0.10.0
[0m19:51:36.668664 [info ] [MainThread]: Updated version available: 0.10.1
[0m19:51:36.668929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a7e1bfc-56c5-4e62-9312-ae498f896e26', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046989d0>]}
[0m19:51:36.669209 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-audit-helper.git
[0m19:51:36.669502 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m19:51:37.125716 [debug] [MainThread]: STDOUT: "b''"
[0m19:51:37.126430 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m19:51:37.126877 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m19:51:37.127151 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:51:37.136603 [debug] [MainThread]: STDOUT: "b'b8f3a3348ce0ff8afc3aa4b9ade2123b00772473\n'"
[0m19:51:37.137113 [debug] [MainThread]: STDERR: "b''"
[0m19:51:37.137371 [debug] [MainThread]: Checking out revision 74072850a5bccd90235576d67530c98e3b7437f4.
[0m19:51:37.137603 [debug] [MainThread]: Executing "git fetch origin --depth 1 74072850a5bccd90235576d67530c98e3b7437f4"
[0m19:51:37.564703 [debug] [MainThread]: STDOUT: "b''"
[0m19:51:37.565402 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            74072850a5bccd90235576d67530c98e3b7437f4 -> FETCH_HEAD\n'"
[0m19:51:37.565706 [debug] [MainThread]: Executing "git reset --hard 74072850a5bccd90235576d67530c98e3b7437f4"
[0m19:51:37.585801 [debug] [MainThread]: STDOUT: "b'HEAD is now at 7407285 Update CI trigger to run off forks (#116)\n'"
[0m19:51:37.586396 [debug] [MainThread]: STDERR: "b''"
[0m19:51:37.586653 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:51:37.595474 [debug] [MainThread]: STDOUT: "b'74072850a5bccd90235576d67530c98e3b7437f4\n'"
[0m19:51:37.596038 [debug] [MainThread]: STDERR: "b''"
[0m19:51:37.596281 [debug] [MainThread]: Checked out at 7407285.
[0m19:51:37.596507 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:51:37.604657 [debug] [MainThread]: STDOUT: "b'74072850a5bccd90235576d67530c98e3b7437f4\n'"
[0m19:51:37.605277 [debug] [MainThread]: STDERR: "b''"
[0m19:51:37.607382 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m19:51:37.615941 [debug] [MainThread]: STDOUT: "b''"
[0m19:51:37.616441 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m19:51:37.616650 [debug] [MainThread]: command return code=128
[0m19:51:37.617391 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m19:51:37.617594 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:51:37.625454 [debug] [MainThread]: STDOUT: "b'74072850a5bccd90235576d67530c98e3b7437f4\n'"
[0m19:51:37.625944 [debug] [MainThread]: STDERR: "b''"
[0m19:51:37.626163 [debug] [MainThread]: Checking out revision 74072850a5bccd90235576d67530c98e3b7437f4.
[0m19:51:37.626359 [debug] [MainThread]: Executing "git fetch origin --depth 1 74072850a5bccd90235576d67530c98e3b7437f4"
[0m19:51:38.033232 [debug] [MainThread]: STDOUT: "b''"
[0m19:51:38.033893 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            74072850a5bccd90235576d67530c98e3b7437f4 -> FETCH_HEAD\n'"
[0m19:51:38.034189 [debug] [MainThread]: Executing "git reset --hard 74072850a5bccd90235576d67530c98e3b7437f4"
[0m19:51:38.053966 [debug] [MainThread]: STDOUT: "b'HEAD is now at 7407285 Update CI trigger to run off forks (#116)\n'"
[0m19:51:38.054567 [debug] [MainThread]: STDERR: "b''"
[0m19:51:38.054819 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m19:51:38.063432 [debug] [MainThread]: STDOUT: "b'74072850a5bccd90235576d67530c98e3b7437f4\n'"
[0m19:51:38.063970 [debug] [MainThread]: STDERR: "b''"
[0m19:51:38.064241 [debug] [MainThread]: Already at 7407285, nothing to do.
[0m19:51:38.064706 [info ] [MainThread]: Installed from revision 74072850a5bccd90235576d67530c98e3b7437f4
[0m19:51:38.065121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8a7e1bfc-56c5-4e62-9312-ae498f896e26', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469ae30>]}
[0m19:51:38.065456 [info ] [MainThread]: 
[0m19:51:38.065685 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m19:51:38.067469 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.9970965, "process_in_blocks": "0", "process_kernel_time": 0.170348, "process_mem_max_rss": "101269504", "process_out_blocks": "0", "process_user_time": 0.799786}
[0m19:51:38.067911 [debug] [MainThread]: Command `dbt deps` succeeded at 19:51:38.067851 after 2.00 seconds
[0m19:51:38.068185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469ae30>]}
[0m19:51:38.068417 [debug] [MainThread]: Flushing usage events
[0m19:51:38.367277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:41.005735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9f280>]}


============================== 19:51:41.008648 | c7abfdcb-ad7d-467b-a8cd-f937375be83a ==============================
[0m19:51:41.008648 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:51:41.009017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:41.670035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10234e9b0>]}
[0m19:51:41.745946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c71f0>]}
[0m19:51:41.746444 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m19:51:41.864665 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:51:41.865274 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:51:41.865526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf0730>]}
[0m19:51:43.176703 [warn ] [MainThread]: [[33mWARNING[0m]: Time spines without YAML configuration are in the process of
deprecation. Please add YAML configuration for your 'metricflow_time_spine'
model. See documentation on MetricFlow time spines:
https://docs.getdbt.com/docs/build/metricflow-time-spine and behavior change
documentation:
https://docs.getdbt.com/reference/global-configs/behavior-changes.
[0m19:51:43.177074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2c76d0>]}
[0m19:51:43.240403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m19:51:43.248805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca35f90>]}
[0m19:51:43.357067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m19:51:43.361768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m19:51:43.375475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d83f5e0>]}
[0m19:51:43.375856 [info ] [MainThread]: Found 13 models, 27 data tests, 6 sources, 19 metrics, 787 macros, 6 semantic models, 3 saved queries, 3 unit tests
[0m19:51:43.376088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7abfdcb-ad7d-467b-a8cd-f937375be83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c4250>]}
[0m19:51:43.377630 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:51:43.377953 [debug] [MainThread]: Command end result
[0m19:51:43.407182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m19:51:43.411795 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m19:51:43.413688 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamara/src/jaffle-shop/dbt/target/run_results.json
[0m19:51:43.413893 [info ] [MainThread]: 
[0m19:51:43.414151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:43.414342 [info ] [MainThread]: 
[0m19:51:43.414543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m19:51:43.415616 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.4540339, "process_in_blocks": "0", "process_kernel_time": 0.26193, "process_mem_max_rss": "207241216", "process_out_blocks": "0", "process_user_time": 2.706552}
[0m19:51:43.415929 [debug] [MainThread]: Command `dbt seed` succeeded at 19:51:43.415884 after 2.45 seconds
[0m19:51:43.416167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103378610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce389d0>]}
[0m19:51:43.416386 [debug] [MainThread]: Flushing usage events
[0m19:51:43.715576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:34.437267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105616410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f0d60>]}


============================== 19:52:34.440565 | 32ac05d5-3227-4382-b994-44298a96620e ==============================
[0m19:52:34.440565 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:52:34.440944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'profiles_dir': '/Users/tamara/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:52:35.119756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470a9b0>]}
[0m19:52:35.189574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23bb80>]}
[0m19:52:35.190235 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m19:52:35.305090 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m19:52:35.459771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:35.460099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:35.464260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m19:52:35.513806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f8130>]}
[0m19:52:35.630964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m19:52:35.637841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m19:52:35.652574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c922ef0>]}
[0m19:52:35.652948 [info ] [MainThread]: Found 13 models, 27 data tests, 6 sources, 19 metrics, 787 macros, 6 semantic models, 3 saved queries, 3 unit tests
[0m19:52:35.653174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c922ad0>]}
[0m19:52:35.654922 [info ] [MainThread]: 
[0m19:52:35.655156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:35.655348 [info ] [MainThread]: 
[0m19:52:35.655667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:52:35.658728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uku-project-437620'
[0m19:52:35.658964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:36.467498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uku-project-437620, now list_uku-project-437620_ds1)
[0m19:52:36.468793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:36.658164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104773910>]}
[0m19:52:36.659612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:36.662610 [debug] [Thread-1 (]: Began running node model.jaffle_shop.metricflow_time_spine
[0m19:52:36.663178 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m19:52:36.663738 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_locations
[0m19:52:36.664844 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_items
[0m19:52:36.664443 [info ] [Thread-1 (]: 1 of 13 START sql table model ds1.metricflow_time_spine ........................ [RUN]
[0m19:52:36.665574 [info ] [Thread-2 (]: 2 of 13 START sql view model ds1.stg_customers ................................. [RUN]
[0m19:52:36.666184 [info ] [Thread-3 (]: 3 of 13 START sql view model ds1.stg_locations ................................. [RUN]
[0m19:52:36.666729 [info ] [Thread-4 (]: 4 of 13 START sql view model ds1.stg_order_items ............................... [RUN]
[0m19:52:36.667254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uku-project-437620_ds1, now model.jaffle_shop.metricflow_time_spine)
[0m19:52:36.667765 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_customers'
[0m19:52:36.668235 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_locations'
[0m19:52:36.668694 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_order_items'
[0m19:52:36.669094 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.metricflow_time_spine
[0m19:52:36.669454 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:52:36.669814 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_locations
[0m19:52:36.670182 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_items
[0m19:52:36.700839 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:52:36.712696 [debug] [Thread-1 (]: On model.jaffle_shop.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.metricflow_time_spine"} */


        select 

    datetime_diff(
        cast(cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval 1 day
        )

 as date) as datetime),
        cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval -3650 day
        )

 as datetime),
        day
    )

  
[0m19:52:36.716563 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_locations"
[0m19:52:36.718766 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_items"
[0m19:52:36.719275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:36.720636 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:52:36.720904 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_items
[0m19:52:36.721176 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_locations
[0m19:52:36.740966 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:52:36.741515 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_items"
[0m19:52:36.743416 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_locations"
[0m19:52:36.744241 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_items"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_order_items`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_items`

),

renamed as (

    select

        ----------  ids
        id as order_item_id,
        order_id,
        sku as product_id

    from source

)

select * from renamed;


[0m19:52:36.744516 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:52:36.745292 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_customers`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_customers`

),

renamed as (

    select

        ----------  ids
        id as customer_id,

        ---------- text
        name as customer_name

    from source

)

select * from renamed;


[0m19:52:36.745577 [debug] [Thread-3 (]: On model.jaffle_shop.stg_locations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_locations"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_locations`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_stores`

),

renamed as (

    select

        ----------  ids
        id as location_id,

        ---------- text
        name as location_name,

        ---------- numerics
        tax_rate,

        ---------- timestamps
        timestamp_trunc(
        cast(opened_at as timestamp),
        day
    ) as opened_date

    from source

)

select * from renamed;


[0m19:52:36.745854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:52:36.746119 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:52:37.229029 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:8a2f64ad-9fc1-45ca-9808-1607c20dbf19&page=queryresults
[0m19:52:37.233084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:05c27907-5808-48bc-a002-6faa332a7f3e&page=queryresults
[0m19:52:37.233827 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:134d83a0-897e-4dd2-986e-693d14436e90&page=queryresults
[0m19:52:37.234537 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:b09b2ec8-4bf3-4c74-b502-888730a97d51&page=queryresults
[0m19:52:37.678599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c239120>]}
[0m19:52:37.679087 [info ] [Thread-2 (]: 2 of 13 OK created sql view model ds1.stg_customers ............................ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m19:52:37.679453 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:52:37.679722 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m19:52:37.679996 [info ] [Thread-2 (]: 5 of 13 START sql view model ds1.stg_orders .................................... [RUN]
[0m19:52:37.680256 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c29dae0>]}
[0m19:52:37.680558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m19:52:37.680760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd3430>]}
[0m19:52:37.681169 [info ] [Thread-4 (]: 4 of 13 OK created sql view model ds1.stg_order_items .......................... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m19:52:37.681447 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:52:37.681795 [info ] [Thread-3 (]: 3 of 13 OK created sql view model ds1.stg_locations ............................ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m19:52:37.682137 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_items
[0m19:52:37.685958 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:52:37.686303 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_locations
[0m19:52:37.686539 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_products
[0m19:52:37.686846 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_supplies
[0m19:52:37.687228 [info ] [Thread-4 (]: 6 of 13 START sql view model ds1.stg_products .................................. [RUN]
[0m19:52:37.687572 [info ] [Thread-3 (]: 7 of 13 START sql view model ds1.stg_supplies .................................. [RUN]
[0m19:52:37.687861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_order_items, now model.jaffle_shop.stg_products)
[0m19:52:37.688143 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:52:37.688371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_locations, now model.jaffle_shop.stg_supplies)
[0m19:52:37.688586 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_products
[0m19:52:37.690472 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m19:52:37.690711 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_supplies
[0m19:52:37.692769 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m19:52:37.702717 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplies"
[0m19:52:37.704469 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_orders`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_orders`

),

renamed as (

    select

        ----------  ids
        id as order_id,
        store_id as location_id,
        customer as customer_id,

        ---------- numerics
        subtotal as subtotal_cents,
        tax_paid as tax_paid_cents,
        order_total as order_total_cents,
        
    round(cast((subtotal / 100) as numeric), 2)
 as subtotal,
        
    round(cast((tax_paid / 100) as numeric), 2)
 as tax_paid,
        
    round(cast((order_total / 100) as numeric), 2)
 as order_total,

        ---------- timestamps
        timestamp_trunc(
        cast(ordered_at as timestamp),
        day
    ) as ordered_at

    from source

)

select * from renamed;


[0m19:52:37.704780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:37.705760 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_products
[0m19:52:37.706034 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_supplies
[0m19:52:37.708530 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m19:52:37.710745 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplies"
[0m19:52:37.711821 [debug] [Thread-4 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_products`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_products`

),

renamed as (

    select

        ----------  ids
        sku as product_id,

        ---------- text
        name as product_name,
        type as product_type,
        description as product_description,


        ---------- numerics
        
    round(cast((price / 100) as numeric), 2)
 as product_price,

        ---------- booleans
        coalesce(type = 'jaffle', false) as is_food_item,

        coalesce(type = 'beverage', false) as is_drink_item

    from source

)

select * from renamed;


[0m19:52:37.712102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:52:37.712963 [debug] [Thread-3 (]: On model.jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplies"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_supplies`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_supplies`

),

renamed as (

    select

        ----------  ids
        to_hex(md5(cast(coalesce(cast(id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sku as string), '_dbt_utils_surrogate_key_null_') as string))) as supply_uuid,
        id as supply_id,
        sku as product_id,

        ---------- text
        name as supply_name,

        ---------- numerics
        
    round(cast((cost / 100) as numeric), 2)
 as supply_cost,

        ---------- booleans
        perishable as is_perishable_supply

    from source

)

select * from renamed;


[0m19:52:37.713241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:52:37.899771 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.metricflow_time_spine"
[0m19:52:37.901199 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.metricflow_time_spine
[0m19:52:37.926760 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.metricflow_time_spine"
[0m19:52:37.927498 [debug] [Thread-1 (]: On model.jaffle_shop.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.metricflow_time_spine"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`metricflow_time_spine`
      
    
    

    OPTIONS()
    as (
      -- metricflow_time_spine.sql
with

days as (

    --for BQ adapters use "DATE('01/01/2000','mm/dd/yyyy')"
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 3651
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( 

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval -3650 day
        )

 as datetime),
        interval (row_number() over (order by 1) - 1) day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval 1 day
        )

 as date)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d



),

cast_to_date as (

    select cast(date_day as date) as date_day

    from days

)

select * from cast_to_date
    );
  
[0m19:52:38.149402 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:c19242e9-5e1f-4e53-99b8-ff94bb48da3d&page=queryresults
[0m19:52:38.152802 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:c349d9eb-090f-49cd-8f3b-5cea11fe4c48&page=queryresults
[0m19:52:38.153934 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:82f1b915-8c89-4a43-b2c6-bca4e5b3af43&page=queryresults
[0m19:52:38.261259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:008aa704-7841-4584-9231-9ae1b6a7066b&page=queryresults
[0m19:52:38.460801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9fb880>]}
[0m19:52:38.464364 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106035a80>]}
[0m19:52:38.465368 [info ] [Thread-2 (]: 5 of 13 OK created sql view model ds1.stg_orders ............................... [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m19:52:38.466352 [info ] [Thread-3 (]: 7 of 13 OK created sql view model ds1.stg_supplies ............................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m19:52:38.467238 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:52:38.468021 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_supplies
[0m19:52:38.468618 [debug] [Thread-2 (]: Began running node model.jaffle_shop.locations
[0m19:52:38.469660 [info ] [Thread-2 (]: 8 of 13 START sql table model ds1.locations .................................... [RUN]
[0m19:52:38.470217 [debug] [Thread-3 (]: Began running node model.jaffle_shop.supplies
[0m19:52:38.470709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.locations)
[0m19:52:38.471288 [info ] [Thread-3 (]: 9 of 13 START sql table model ds1.supplies ..................................... [RUN]
[0m19:52:38.471784 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.locations
[0m19:52:38.472266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_supplies, now model.jaffle_shop.supplies)
[0m19:52:38.478554 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.locations"
[0m19:52:38.479018 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.supplies
[0m19:52:38.482542 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.supplies"
[0m19:52:38.483230 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.supplies
[0m19:52:38.483626 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.locations
[0m19:52:38.486833 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.supplies"
[0m19:52:38.490311 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.locations"
[0m19:52:38.492230 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c331e40>]}
[0m19:52:38.493003 [info ] [Thread-4 (]: 6 of 13 OK created sql view model ds1.stg_products ............................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m19:52:38.493721 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_products
[0m19:52:38.494155 [debug] [Thread-3 (]: On model.jaffle_shop.supplies: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.supplies"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`supplies`
      
    
    

    OPTIONS()
    as (
      with

supplies as (

    select * from `uku-project-437620`.`ds1`.`stg_supplies`

)

select * from supplies
    );
  
[0m19:52:38.494650 [debug] [Thread-2 (]: On model.jaffle_shop.locations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.locations"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`locations`
      
    
    

    OPTIONS()
    as (
      with

locations as (

    select * from `uku-project-437620`.`ds1`.`stg_locations`

)

select * from locations
    );
  
[0m19:52:38.495177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:38.495514 [debug] [Thread-4 (]: Began running node model.jaffle_shop.order_items
[0m19:52:38.495858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:52:38.497004 [info ] [Thread-4 (]: 10 of 13 START sql table model ds1.order_items ................................. [RUN]
[0m19:52:38.498204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_products, now model.jaffle_shop.order_items)
[0m19:52:38.498639 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.order_items
[0m19:52:38.503195 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.order_items"
[0m19:52:38.504622 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.order_items
[0m19:52:38.507273 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.order_items"
[0m19:52:38.507904 [debug] [Thread-4 (]: On model.jaffle_shop.order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_items"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`order_items`
      
    
    

    OPTIONS()
    as (
      with

order_items as (

    select * from `uku-project-437620`.`ds1`.`stg_order_items`

),


orders as (

    select * from `uku-project-437620`.`ds1`.`stg_orders`

),

products as (

    select * from `uku-project-437620`.`ds1`.`stg_products`

),

supplies as (

    select * from `uku-project-437620`.`ds1`.`stg_supplies`

),

order_supplies_summary as (

    select
        product_id,

        sum(supply_cost) as supply_cost

    from supplies

    group by 1

),

joined as (

    select
        order_items.*,

        orders.ordered_at,

        products.product_name,
        products.product_price,
        products.is_food_item,
        products.is_drink_item,

        order_supplies_summary.supply_cost

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
    );
  
[0m19:52:38.508279 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:52:39.069994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:7cc1beab-59b1-4e9e-9b5f-9b33260eea28&page=queryresults
[0m19:52:39.075094 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:35fd028f-a337-4e13-b425-ecf06ea7cc1b&page=queryresults
[0m19:52:39.076135 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:df2ef0ac-8c98-4415-b29f-54f350bb52f3&page=queryresults
[0m19:52:41.106738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d40f760>]}
[0m19:52:41.108395 [info ] [Thread-3 (]: 9 of 13 OK created sql table model ds1.supplies ................................ [[32mCREATE TABLE (65.0 rows, 2.7 KiB processed)[0m in 2.63s]
[0m19:52:41.109512 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.supplies
[0m19:52:41.110293 [debug] [Thread-3 (]: Began running node model.jaffle_shop.products
[0m19:52:41.111146 [info ] [Thread-3 (]: 11 of 13 START sql table model ds1.products .................................... [RUN]
[0m19:52:41.112052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.supplies, now model.jaffle_shop.products)
[0m19:52:41.112742 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.products
[0m19:52:41.118835 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.products"
[0m19:52:41.120114 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.products
[0m19:52:41.124299 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.products"
[0m19:52:41.125326 [debug] [Thread-3 (]: On model.jaffle_shop.products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.products"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`products`
      
    
    

    OPTIONS()
    as (
      with

products as (

    select * from `uku-project-437620`.`ds1`.`stg_products`

)

select * from products
    );
  
[0m19:52:41.125803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:52:42.348269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0c38e0>]}
[0m19:52:42.349838 [info ] [Thread-1 (]: 1 of 13 OK created sql table model ds1.metricflow_time_spine ................... [[32mCREATE TABLE (3.7k rows, 0 processed)[0m in 5.68s]
[0m19:52:42.350921 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.metricflow_time_spine
[0m19:52:42.554165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d65c0>]}
[0m19:52:42.555688 [info ] [Thread-2 (]: 8 of 13 OK created sql table model ds1.locations ............................... [[32mCREATE TABLE (6.0 rows, 398.0 Bytes processed)[0m in 4.08s]
[0m19:52:42.556768 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.locations
[0m19:52:42.874244 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:98e876ef-fe50-4e09-a994-3f4dbaf93c77&page=queryresults
[0m19:52:43.196812 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d7550>]}
[0m19:52:43.198395 [info ] [Thread-4 (]: 10 of 13 OK created sql table model ds1.order_items ............................ [[32mCREATE TABLE (90.9k rows, 10.1 MiB processed)[0m in 4.70s]
[0m19:52:43.199486 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.order_items
[0m19:52:43.200561 [debug] [Thread-1 (]: Began running node model.jaffle_shop.orders
[0m19:52:43.201368 [info ] [Thread-1 (]: 12 of 13 START sql table model ds1.orders ...................................... [RUN]
[0m19:52:43.202072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.metricflow_time_spine, now model.jaffle_shop.orders)
[0m19:52:43.202625 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.orders
[0m19:52:43.210603 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m19:52:43.211858 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.orders
[0m19:52:43.215791 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m19:52:43.216780 [debug] [Thread-1 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`orders`
      
    
    

    OPTIONS()
    as (
      with

orders as (

    select * from `uku-project-437620`.`ds1`.`stg_orders`

),

order_items as (

    select * from `uku-project-437620`.`ds1`.`order_items`

),

order_items_summary as (

    select
        order_id,

        sum(supply_cost) as order_cost,
        sum(product_price) as order_items_subtotal,
        count(order_item_id) as count_order_items,
        sum(
            case
                when is_food_item then 1
                else 0
            end
        ) as count_food_items,
        sum(
            case
                when is_drink_item then 1
                else 0
            end
        ) as count_drink_items

    from order_items

    group by 1

),

compute_booleans as (

    select
        orders.*,

        order_items_summary.order_cost,
        order_items_summary.order_items_subtotal,
        order_items_summary.count_food_items,
        order_items_summary.count_drink_items,
        order_items_summary.count_order_items,
        order_items_summary.count_food_items > 0 as is_food_order,
        order_items_summary.count_drink_items > 0 as is_drink_order

    from orders

    left join
        order_items_summary
        on orders.order_id = order_items_summary.order_id

),

customer_order_count as (

    select
        *,

        row_number() over (
            partition by customer_id
            order by ordered_at asc
        ) as customer_order_number

    from compute_booleans

)

select * from customer_order_count
    );
  
[0m19:52:43.217310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:43.989337 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:aae33234-2947-4009-b75e-2fa6363e002f&page=queryresults
[0m19:52:45.114086 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d40f760>]}
[0m19:52:45.115628 [info ] [Thread-3 (]: 11 of 13 OK created sql table model ds1.products ............................... [[32mCREATE TABLE (10.0 rows, 949.0 Bytes processed)[0m in 4.00s]
[0m19:52:45.116580 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.products
[0m19:52:47.676443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d42cac0>]}
[0m19:52:47.678093 [info ] [Thread-1 (]: 12 of 13 OK created sql table model ds1.orders ................................. [[32mCREATE TABLE (61.9k rows, 18.2 MiB processed)[0m in 4.47s]
[0m19:52:47.679153 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.orders
[0m19:52:47.680268 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m19:52:47.681150 [info ] [Thread-4 (]: 13 of 13 START sql table model ds1.customers ................................... [RUN]
[0m19:52:47.682083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_items, now model.jaffle_shop.customers)
[0m19:52:47.682739 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m19:52:47.689095 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m19:52:47.690369 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m19:52:47.694159 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m19:52:47.694901 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`customers`
      
    
    

    OPTIONS()
    as (
      with

customers as (

    select * from `uku-project-437620`.`ds1`.`stg_customers`

),

orders as (

    select * from `uku-project-437620`.`ds1`.`orders`

),

customer_orders_summary as (

    select
        orders.customer_id,

        count(distinct orders.order_id) as count_lifetime_orders,
        count(distinct orders.order_id) > 1 as is_repeat_buyer,
        min(orders.ordered_at) as first_ordered_at,
        max(orders.ordered_at) as last_ordered_at,
        sum(orders.subtotal) as lifetime_spend_pretax,
        sum(orders.tax_paid) as lifetime_tax_paid,
        sum(orders.order_total) as lifetime_spend

    from orders

    group by 1

),

joined as (

    select
        customers.*,

        customer_orders_summary.count_lifetime_orders,
        customer_orders_summary.first_ordered_at,
        customer_orders_summary.last_ordered_at,
        customer_orders_summary.lifetime_spend_pretax,
        customer_orders_summary.lifetime_tax_paid,
        customer_orders_summary.lifetime_spend,

        case
            when customer_orders_summary.is_repeat_buyer then 'returning'
            else 'new'
        end as customer_type

    from customers

    left join customer_orders_summary
        on customers.customer_id = customer_orders_summary.customer_id

)

select * from joined
    );
  
[0m19:52:47.695394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:52:48.390820 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:28626002-465c-400b-ab1c-b16c813a7c19&page=queryresults
[0m19:52:51.157487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ac05d5-3227-4382-b994-44298a96620e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d40f760>]}
[0m19:52:51.159137 [info ] [Thread-4 (]: 13 of 13 OK created sql table model ds1.customers .............................. [[32mCREATE TABLE (935.0 rows, 7.8 MiB processed)[0m in 3.48s]
[0m19:52:51.160205 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m19:52:51.162367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:51.163430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:51.163943 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m19:52:51.164422 [debug] [MainThread]: Connection 'model.jaffle_shop.locations' was properly closed.
[0m19:52:51.164873 [debug] [MainThread]: Connection 'model.jaffle_shop.products' was properly closed.
[0m19:52:51.165320 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m19:52:51.165971 [info ] [MainThread]: 
[0m19:52:51.166520 [info ] [MainThread]: Finished running 7 table models, 6 view models in 0 hours 0 minutes and 15.51 seconds (15.51s).
[0m19:52:51.169413 [debug] [MainThread]: Command end result
[0m19:52:51.216867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m19:52:51.222483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m19:52:51.227011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamara/src/jaffle-shop/dbt/target/run_results.json
[0m19:52:51.227245 [info ] [MainThread]: 
[0m19:52:51.227519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:51.227736 [info ] [MainThread]: 
[0m19:52:51.227957 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m19:52:51.229396 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.838928, "process_in_blocks": "0", "process_kernel_time": 0.368918, "process_mem_max_rss": "206602240", "process_out_blocks": "0", "process_user_time": 2.261457}
[0m19:52:51.229741 [debug] [MainThread]: Command `dbt run` succeeded at 19:52:51.229689 after 16.84 seconds
[0m19:52:51.230000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105616410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105734130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470a9b0>]}
[0m19:52:51.230243 [debug] [MainThread]: Flushing usage events
[0m19:52:51.631728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:06.546260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cda380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb6b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb7220>]}


============================== 20:38:06.549551 | 2d7821c3-a3f2-4896-937a-856eeb24f166 ==============================
[0m20:38:06.549551 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:38:06.549938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tamara/.dbt', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:07.201839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e89d0>]}
[0m20:38:07.273215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707cc10>]}
[0m20:38:07.273744 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m20:38:07.386351 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:38:07.539878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:07.540179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:07.544317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:38:07.593852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c03a0>]}
[0m20:38:07.711313 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:38:07.717545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:38:07.732436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c25f0>]}
[0m20:38:07.732799 [info ] [MainThread]: Found 13 models, 27 data tests, 6 sources, 19 metrics, 787 macros, 6 semantic models, 3 saved queries, 3 unit tests
[0m20:38:07.733021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c39a0>]}
[0m20:38:07.734753 [info ] [MainThread]: 
[0m20:38:07.734983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:07.735175 [info ] [MainThread]: 
[0m20:38:07.735488 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:38:07.738456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uku-project-437620'
[0m20:38:07.738683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:08.544615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uku-project-437620, now list_uku-project-437620_ds1)
[0m20:38:08.545800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:08.772740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3a4a0>]}
[0m20:38:08.774122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:08.777138 [debug] [Thread-1 (]: Began running node model.jaffle_shop.metricflow_time_spine
[0m20:38:08.777747 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m20:38:08.778325 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_locations
[0m20:38:08.779566 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_items
[0m20:38:08.779098 [info ] [Thread-1 (]: 1 of 13 START sql table model ds1.metricflow_time_spine ........................ [RUN]
[0m20:38:08.780411 [info ] [Thread-2 (]: 2 of 13 START sql view model ds1.stg_customers ................................. [RUN]
[0m20:38:08.780992 [info ] [Thread-3 (]: 3 of 13 START sql view model ds1.stg_locations ................................. [RUN]
[0m20:38:08.781674 [info ] [Thread-4 (]: 4 of 13 START sql view model ds1.stg_order_items ............................... [RUN]
[0m20:38:08.782243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uku-project-437620_ds1, now model.jaffle_shop.metricflow_time_spine)
[0m20:38:08.782810 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_customers'
[0m20:38:08.783345 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_locations'
[0m20:38:08.783870 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_order_items'
[0m20:38:08.784322 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.metricflow_time_spine
[0m20:38:08.784738 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:38:08.785142 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_locations
[0m20:38:08.785541 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_items
[0m20:38:08.810911 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:38:08.829939 [debug] [Thread-1 (]: On model.jaffle_shop.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.metricflow_time_spine"} */


        select 

    datetime_diff(
        cast(cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval 1 day
        )

 as date) as datetime),
        cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval -3650 day
        )

 as datetime),
        day
    )

  
[0m20:38:08.834429 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_locations"
[0m20:38:08.836646 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_items"
[0m20:38:08.837051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:08.838277 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:38:08.843636 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_locations
[0m20:38:08.855211 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:38:08.857184 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_locations"
[0m20:38:08.857617 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_items
[0m20:38:08.858113 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_customers`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_customers`

),

renamed as (

    select

        ----------  ids
        id as customer_id,

        ---------- text
        name as customer_name

    from source

)

select * from renamed;


[0m20:38:08.860127 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_order_items"
[0m20:38:08.860433 [debug] [Thread-3 (]: On model.jaffle_shop.stg_locations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_locations"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_locations`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_stores`

),

renamed as (

    select

        ----------  ids
        id as location_id,

        ---------- text
        name as location_name,

        ---------- numerics
        tax_rate,

        ---------- timestamps
        timestamp_trunc(
        cast(opened_at as timestamp),
        day
    ) as opened_date

    from source

)

select * from renamed;


[0m20:38:08.860673 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:38:08.860977 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:38:08.861771 [debug] [Thread-4 (]: On model.jaffle_shop.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_order_items"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_order_items`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_items`

),

renamed as (

    select

        ----------  ids
        id as order_item_id,
        order_id,
        sku as product_id

    from source

)

select * from renamed;


[0m20:38:08.862478 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:38:09.331735 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:83e83d2b-1deb-4046-a337-13610db8dde3&page=queryresults
[0m20:38:09.339043 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:cb8da087-726b-4948-8d0e-1ec7828f8a47&page=queryresults
[0m20:38:09.370293 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:ca1cbd14-5440-48c8-84cc-a6b512a0f7f7&page=queryresults
[0m20:38:09.477822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:651318bf-8ba6-462a-9db3-557f0a70291d&page=queryresults
[0m20:38:09.858236 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3f220>]}
[0m20:38:09.858588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8ea0e0>]}
[0m20:38:09.859001 [info ] [Thread-3 (]: 3 of 13 OK created sql view model ds1.stg_locations ............................ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m20:38:09.859232 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023280>]}
[0m20:38:09.859640 [info ] [Thread-2 (]: 2 of 13 OK created sql view model ds1.stg_customers ............................ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m20:38:09.860035 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_locations
[0m20:38:09.860386 [info ] [Thread-4 (]: 4 of 13 OK created sql view model ds1.stg_order_items .......................... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m20:38:09.860734 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:38:09.860995 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m20:38:09.861304 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_items
[0m20:38:09.861651 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_products
[0m20:38:09.861921 [info ] [Thread-3 (]: 5 of 13 START sql view model ds1.stg_orders .................................... [RUN]
[0m20:38:09.862221 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_supplies
[0m20:38:09.862516 [info ] [Thread-2 (]: 6 of 13 START sql view model ds1.stg_products .................................. [RUN]
[0m20:38:09.862803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_locations, now model.jaffle_shop.stg_orders)
[0m20:38:09.863099 [info ] [Thread-4 (]: 7 of 13 START sql view model ds1.stg_supplies .................................. [RUN]
[0m20:38:09.863347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_products)
[0m20:38:09.863563 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:38:09.863783 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_order_items, now model.jaffle_shop.stg_supplies)
[0m20:38:09.863995 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:38:09.867852 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:38:09.868109 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_supplies
[0m20:38:09.870205 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:38:09.879383 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplies"
[0m20:38:09.879863 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:38:09.882762 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:38:09.883038 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_products
[0m20:38:09.885112 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_products"
[0m20:38:09.885389 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_supplies
[0m20:38:09.887364 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_supplies"
[0m20:38:09.887672 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_orders`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_orders`

),

renamed as (

    select

        ----------  ids
        id as order_id,
        store_id as location_id,
        customer as customer_id,

        ---------- numerics
        subtotal as subtotal_cents,
        tax_paid as tax_paid_cents,
        order_total as order_total_cents,
        
    round(cast((subtotal / 100) as numeric), 2)
 as subtotal,
        
    round(cast((tax_paid / 100) as numeric), 2)
 as tax_paid,
        
    round(cast((order_total / 100) as numeric), 2)
 as order_total,

        ---------- timestamps
        timestamp_trunc(
        cast(ordered_at as timestamp),
        day
    ) as ordered_at

    from source

)

select * from renamed;


[0m20:38:09.888111 [debug] [Thread-2 (]: On model.jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_products"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_products`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_products`

),

renamed as (

    select

        ----------  ids
        sku as product_id,

        ---------- text
        name as product_name,
        type as product_type,
        description as product_description,


        ---------- numerics
        
    round(cast((price / 100) as numeric), 2)
 as product_price,

        ---------- booleans
        coalesce(type = 'jaffle', false) as is_food_item,

        coalesce(type = 'beverage', false) as is_drink_item

    from source

)

select * from renamed;


[0m20:38:09.888376 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:09.888657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:09.888915 [debug] [Thread-4 (]: On model.jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_supplies"} */


  create or replace view `uku-project-437620`.`ds1`.`stg_supplies`
  OPTIONS()
  as with

source as (

    select * from `uku-project-437620`.`raw`.`raw_supplies`

),

renamed as (

    select

        ----------  ids
        to_hex(md5(cast(coalesce(cast(id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(sku as string), '_dbt_utils_surrogate_key_null_') as string))) as supply_uuid,
        id as supply_id,
        sku as product_id,

        ---------- text
        name as supply_name,

        ---------- numerics
        
    round(cast((cost / 100) as numeric), 2)
 as supply_cost,

        ---------- booleans
        perishable as is_perishable_supply

    from source

)

select * from renamed;


[0m20:38:09.890238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:38:10.169872 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.metricflow_time_spine"
[0m20:38:10.171537 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.metricflow_time_spine
[0m20:38:10.336151 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:01208bef-ed93-431b-a95b-3824732edd79&page=queryresults
[0m20:38:10.338972 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:7e941986-624b-4396-8fe7-7d6133339d3e&page=queryresults
[0m20:38:10.340943 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:4397c92e-1688-4103-a821-c5a303df42fb&page=queryresults
[0m20:38:10.448807 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.metricflow_time_spine"
[0m20:38:10.450052 [debug] [Thread-1 (]: On model.jaffle_shop.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.metricflow_time_spine"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`metricflow_time_spine`
      
    
    

    OPTIONS()
    as (
      -- metricflow_time_spine.sql
with

days as (

    --for BQ adapters use "DATE('01/01/2000','mm/dd/yyyy')"
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 3651
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( 

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval -3650 day
        )

 as datetime),
        interval (row_number() over (order by 1) - 1) day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval 1 day
        )

 as date)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d



),

cast_to_date as (

    select cast(date_day as date) as date_day

    from days

)

select * from cast_to_date
    );
  
[0m20:38:10.693234 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1601f0>]}
[0m20:38:10.694577 [info ] [Thread-4 (]: 7 of 13 OK created sql view model ds1.stg_supplies ............................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m20:38:10.695494 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_supplies
[0m20:38:10.696136 [debug] [Thread-4 (]: Began running node model.jaffle_shop.locations
[0m20:38:10.698617 [info ] [Thread-4 (]: 8 of 13 START sql table model ds1.locations .................................... [RUN]
[0m20:38:10.699330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_supplies, now model.jaffle_shop.locations)
[0m20:38:10.699811 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.locations
[0m20:38:10.706217 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.locations"
[0m20:38:10.707699 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.locations
[0m20:38:10.710868 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:38:10.805017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef738e0>]}
[0m20:38:10.805969 [info ] [Thread-2 (]: 6 of 13 OK created sql view model ds1.stg_products ............................. [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m20:38:10.806620 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_products
[0m20:38:10.807094 [debug] [Thread-2 (]: Began running node model.jaffle_shop.supplies
[0m20:38:10.807691 [info ] [Thread-2 (]: 9 of 13 START sql table model ds1.supplies ..................................... [RUN]
[0m20:38:10.808306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_products, now model.jaffle_shop.supplies)
[0m20:38:10.808728 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.supplies
[0m20:38:10.812337 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.supplies"
[0m20:38:10.813135 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.supplies
[0m20:38:10.815871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:10.823740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:6561fb7f-bff7-4594-baf5-b3e96a192434&page=queryresults
[0m20:38:10.831018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b07c70>]}
[0m20:38:10.831590 [info ] [Thread-3 (]: 5 of 13 OK created sql view model ds1.stg_orders ............................... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m20:38:10.832082 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:38:10.832418 [debug] [Thread-3 (]: Began running node model.jaffle_shop.products
[0m20:38:10.832904 [info ] [Thread-3 (]: 10 of 13 START sql table model ds1.products .................................... [RUN]
[0m20:38:10.833302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.products)
[0m20:38:10.833624 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.products
[0m20:38:10.837226 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.products"
[0m20:38:10.838171 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.products
[0m20:38:10.840460 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:10.951613 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.locations"
[0m20:38:10.952489 [debug] [Thread-4 (]: On model.jaffle_shop.locations: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.locations"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`locations`
      
    
    

    OPTIONS()
    as (
      with

locations as (

    select * from `uku-project-437620`.`ds1`.`stg_locations`

)

select * from locations
    );
  
[0m20:38:11.026847 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.supplies"
[0m20:38:11.028178 [debug] [Thread-2 (]: On model.jaffle_shop.supplies: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.supplies"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`supplies`
      
    
    

    OPTIONS()
    as (
      with

supplies as (

    select * from `uku-project-437620`.`ds1`.`stg_supplies`

)

select * from supplies
    );
  
[0m20:38:11.069563 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.products"
[0m20:38:11.070773 [debug] [Thread-3 (]: On model.jaffle_shop.products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.products"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`products`
      
    
    

    OPTIONS()
    as (
      with

products as (

    select * from `uku-project-437620`.`ds1`.`stg_products`

)

select * from products
    );
  
[0m20:38:11.580343 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:0278e8d7-a087-4bf6-9f6f-4aacb3b9c24c&page=queryresults
[0m20:38:11.597435 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:2e6c6ca6-8e81-4a36-b67b-02bdd2f762af&page=queryresults
[0m20:38:11.598222 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:f4c65277-24a1-409d-b878-b43a249f6fb1&page=queryresults
[0m20:38:13.738563 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0524d0>]}
[0m20:38:13.740025 [info ] [Thread-3 (]: 10 of 13 OK created sql table model ds1.products ............................... [[32mCREATE TABLE (10.0 rows, 949.0 Bytes processed)[0m in 2.91s]
[0m20:38:13.741226 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.products
[0m20:38:13.742162 [debug] [Thread-3 (]: Began running node model.jaffle_shop.order_items
[0m20:38:13.743089 [info ] [Thread-3 (]: 11 of 13 START sql table model ds1.order_items ................................. [RUN]
[0m20:38:13.743960 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.products, now model.jaffle_shop.order_items)
[0m20:38:13.744655 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.order_items
[0m20:38:13.750781 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.order_items"
[0m20:38:13.751809 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.order_items
[0m20:38:13.755308 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:38:13.763855 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef738e0>]}
[0m20:38:13.764553 [info ] [Thread-2 (]: 9 of 13 OK created sql table model ds1.supplies ................................ [[32mCREATE TABLE (65.0 rows, 2.7 KiB processed)[0m in 2.96s]
[0m20:38:13.765111 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.supplies
[0m20:38:13.970782 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.order_items"
[0m20:38:13.971829 [debug] [Thread-3 (]: On model.jaffle_shop.order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_items"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`order_items`
      
    
    

    OPTIONS()
    as (
      with

order_items as (

    select * from `uku-project-437620`.`ds1`.`stg_order_items`

),


orders as (

    select * from `uku-project-437620`.`ds1`.`stg_orders`

),

products as (

    select * from `uku-project-437620`.`ds1`.`stg_products`

),

supplies as (

    select * from `uku-project-437620`.`ds1`.`stg_supplies`

),

order_supplies_summary as (

    select
        product_id,

        sum(supply_cost) as supply_cost

    from supplies

    group by 1

),

joined as (

    select
        order_items.*,

        orders.ordered_at,

        products.product_name,
        products.product_price,
        products.is_food_item,
        products.is_drink_item,

        order_supplies_summary.supply_cost

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
    );
  
[0m20:38:14.249543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b13250>]}
[0m20:38:14.250586 [info ] [Thread-1 (]: 1 of 13 OK created sql table model ds1.metricflow_time_spine ................... [[32mCREATE TABLE (3.7k rows, 0 processed)[0m in 5.47s]
[0m20:38:14.251424 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.metricflow_time_spine
[0m20:38:14.462827 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:19869f32-d724-4bf4-b721-47ea02224457&page=queryresults
[0m20:38:14.793735 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f050400>]}
[0m20:38:14.794980 [info ] [Thread-4 (]: 8 of 13 OK created sql table model ds1.locations ............................... [[32mCREATE TABLE (6.0 rows, 398.0 Bytes processed)[0m in 4.09s]
[0m20:38:14.795848 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.locations
[0m20:38:18.176674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d13bb0>]}
[0m20:38:18.178072 [info ] [Thread-3 (]: 11 of 13 OK created sql table model ds1.order_items ............................ [[32mCREATE TABLE (90.9k rows, 10.1 MiB processed)[0m in 4.43s]
[0m20:38:18.178969 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.order_items
[0m20:38:18.180090 [debug] [Thread-2 (]: Began running node model.jaffle_shop.orders
[0m20:38:18.180831 [info ] [Thread-2 (]: 12 of 13 START sql table model ds1.orders ...................................... [RUN]
[0m20:38:18.181529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.supplies, now model.jaffle_shop.orders)
[0m20:38:18.182034 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.orders
[0m20:38:18.188976 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m20:38:18.190035 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.orders
[0m20:38:18.193195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:18.442933 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m20:38:18.445349 [debug] [Thread-2 (]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`orders`
      
    
    

    OPTIONS()
    as (
      with

orders as (

    select * from `uku-project-437620`.`ds1`.`stg_orders`

),

order_items as (

    select * from `uku-project-437620`.`ds1`.`order_items`

),

order_items_summary as (

    select
        order_id,

        sum(supply_cost) as order_cost,
        sum(product_price) as order_items_subtotal,
        count(order_item_id) as count_order_items,
        sum(
            case
                when is_food_item then 1
                else 0
            end
        ) as count_food_items,
        sum(
            case
                when is_drink_item then 1
                else 0
            end
        ) as count_drink_items

    from order_items

    group by 1

),

compute_booleans as (

    select
        orders.*,

        order_items_summary.order_cost,
        order_items_summary.order_items_subtotal,
        order_items_summary.count_food_items,
        order_items_summary.count_drink_items,
        order_items_summary.count_order_items,
        order_items_summary.count_food_items > 0 as is_food_order,
        order_items_summary.count_drink_items > 0 as is_drink_order

    from orders

    left join
        order_items_summary
        on orders.order_id = order_items_summary.order_id

),

customer_order_count as (

    select
        *,

        row_number() over (
            partition by customer_id
            order by ordered_at asc
        ) as customer_order_number

    from compute_booleans

)

select * from customer_order_count
    );
  
[0m20:38:18.940765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:757a2703-dadd-48fa-9a35-94b68b798dbd&page=queryresults
[0m20:38:22.170276 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d69090>]}
[0m20:38:22.170995 [info ] [Thread-2 (]: 12 of 13 OK created sql table model ds1.orders ................................. [[32mCREATE TABLE (61.9k rows, 18.2 MiB processed)[0m in 3.99s]
[0m20:38:22.171488 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.orders
[0m20:38:22.171999 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m20:38:22.172713 [info ] [Thread-4 (]: 13 of 13 START sql table model ds1.customers ................................... [RUN]
[0m20:38:22.174009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.locations, now model.jaffle_shop.customers)
[0m20:38:22.174780 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m20:38:22.177805 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:38:22.178341 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m20:38:22.180483 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:38:22.400032 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:38:22.403210 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */

  
    

    create or replace table `uku-project-437620`.`ds1`.`customers`
      
    
    

    OPTIONS()
    as (
      with

customers as (

    select * from `uku-project-437620`.`ds1`.`stg_customers`

),

orders as (

    select * from `uku-project-437620`.`ds1`.`orders`

),

customer_orders_summary as (

    select
        orders.customer_id,

        count(distinct orders.order_id) as count_lifetime_orders,
        count(distinct orders.order_id) > 1 as is_repeat_buyer,
        min(orders.ordered_at) as first_ordered_at,
        max(orders.ordered_at) as last_ordered_at,
        sum(orders.subtotal) as lifetime_spend_pretax,
        sum(orders.tax_paid) as lifetime_tax_paid,
        sum(orders.order_total) as lifetime_spend

    from orders

    group by 1

),

joined as (

    select
        customers.*,

        customer_orders_summary.count_lifetime_orders,
        customer_orders_summary.first_ordered_at,
        customer_orders_summary.last_ordered_at,
        customer_orders_summary.lifetime_spend_pretax,
        customer_orders_summary.lifetime_tax_paid,
        customer_orders_summary.lifetime_spend,

        case
            when customer_orders_summary.is_repeat_buyer then 'returning'
            else 'new'
        end as customer_type

    from customers

    left join customer_orders_summary
        on customers.customer_id = customer_orders_summary.customer_id

)

select * from joined
    );
  
[0m20:38:22.973831 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:ce335f8a-bb82-4c61-9888-98e9cbdb1543&page=queryresults
[0m20:38:25.854140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d7821c3-a3f2-4896-937a-856eeb24f166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4d420>]}
[0m20:38:25.855599 [info ] [Thread-4 (]: 13 of 13 OK created sql table model ds1.customers .............................. [[32mCREATE TABLE (935.0 rows, 7.8 MiB processed)[0m in 3.68s]
[0m20:38:25.856741 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m20:38:25.858744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:25.859989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:25.861159 [debug] [MainThread]: Connection 'model.jaffle_shop.metricflow_time_spine' was properly closed.
[0m20:38:25.861933 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m20:38:25.862477 [debug] [MainThread]: Connection 'model.jaffle_shop.order_items' was properly closed.
[0m20:38:25.863053 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m20:38:25.863946 [info ] [MainThread]: 
[0m20:38:25.864663 [info ] [MainThread]: Finished running 7 table models, 6 view models in 0 hours 0 minutes and 18.13 seconds (18.13s).
[0m20:38:25.870120 [debug] [MainThread]: Command end result
[0m20:38:25.910373 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:38:25.915831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:38:25.920761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamara/src/jaffle-shop/dbt/target/run_results.json
[0m20:38:25.921069 [info ] [MainThread]: 
[0m20:38:25.921347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:38:25.921561 [info ] [MainThread]: 
[0m20:38:25.921771 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m20:38:25.923405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.424656, "process_in_blocks": "0", "process_kernel_time": 0.354998, "process_mem_max_rss": "207503360", "process_out_blocks": "0", "process_user_time": 2.254695}
[0m20:38:25.923926 [debug] [MainThread]: Command `dbt run` succeeded at 20:38:25.923858 after 19.43 seconds
[0m20:38:25.924205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cda380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e13370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707cc10>]}
[0m20:38:25.924458 [debug] [MainThread]: Flushing usage events
[0m20:38:26.358652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:02.813167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ee3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a2ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a3400>]}


============================== 20:39:02.815722 | 345fe3f2-f39d-41f5-a17b-ea7d6abddc6b ==============================
[0m20:39:02.815722 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:39:02.816121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:39:03.252480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026e2980>]}
[0m20:39:03.325835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcea350>]}
[0m20:39:03.326482 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m20:39:03.434058 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:39:03.574126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:03.574547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:03.578520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:39:03.627088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c0400>]}
[0m20:39:03.744956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:39:03.750861 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:39:03.768016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f2050>]}
[0m20:39:03.768406 [info ] [MainThread]: Found 13 models, 27 data tests, 6 sources, 19 metrics, 787 macros, 6 semantic models, 3 saved queries, 3 unit tests
[0m20:39:03.768642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c51ec20>]}
[0m20:39:03.770885 [info ] [MainThread]: 
[0m20:39:03.771148 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:03.771346 [info ] [MainThread]: 
[0m20:39:03.771666 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:03.774653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uku-project-437620_ds1'
[0m20:39:03.774949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:04.450050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '345fe3f2-f39d-41f5-a17b-ea7d6abddc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10372f190>]}
[0m20:39:04.451332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:04.454604 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:04.455228 [debug] [Thread-2 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:04.455810 [debug] [Thread-3 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:04.456792 [debug] [Thread-4 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:04.456402 [info ] [Thread-1 (]: 1 of 30 START test accepted_values_customers_customer_type__new__returning ..... [RUN]
[0m20:39:04.457557 [info ] [Thread-2 (]: 2 of 30 START test dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend  [RUN]
[0m20:39:04.458063 [info ] [Thread-3 (]: 3 of 30 START test dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal  [RUN]
[0m20:39:04.458542 [info ] [Thread-4 (]: 4 of 30 START test dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid  [RUN]
[0m20:39:04.459169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uku-project-437620_ds1, now test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8)
[0m20:39:04.459766 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6'
[0m20:39:04.460333 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec'
[0m20:39:04.460888 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92'
[0m20:39:04.461351 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:04.461778 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:04.462205 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:04.462603 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:04.482688 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8"
[0m20:39:04.491098 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6"
[0m20:39:04.496297 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec"
[0m20:39:04.500050 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92"
[0m20:39:04.500890 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:04.507618 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:04.517448 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec"
[0m20:39:04.517799 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:04.518624 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6"
[0m20:39:04.518962 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:04.521292 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8"
[0m20:39:04.523240 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92"
[0m20:39:04.523626 [debug] [Thread-3 (]: On test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from `uku-project-437620`.`ds1`.`orders`

where not(order_items_subtotal = subtotal)


      
    ) dbt_internal_test
[0m20:39:04.524029 [debug] [Thread-2 (]: On test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from `uku-project-437620`.`ds1`.`customers`

where not(lifetime_spend_pretax + lifetime_tax_paid = lifetime_spend)


      
    ) dbt_internal_test
[0m20:39:04.524345 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_type as value_field,
        count(*) as n_records

    from `uku-project-437620`.`ds1`.`customers`
    group by customer_type

)

select *
from all_values
where value_field not in (
    'new','returning'
)



      
    ) dbt_internal_test
[0m20:39:04.524606 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:04.524873 [debug] [Thread-4 (]: On test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from `uku-project-437620`.`ds1`.`orders`

where not(order_total = subtotal + tax_paid)


      
    ) dbt_internal_test
[0m20:39:04.525114 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:39:04.525377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:04.526192 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:39:05.959981 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:0842a0ae-279c-4fbe-b5fe-f8eeadabaa4a&page=queryresults
[0m20:39:05.965813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:07bc1a8d-7f9f-4cb5-89b8-3ed3d802d0e0&page=queryresults
[0m20:39:05.967091 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:305a3fb3-37be-4399-9a10-1b5b8c6fdf0d&page=queryresults
[0m20:39:05.967844 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:84da9d48-d6b2-4a60-b251-06d7bb33fd14&page=queryresults
[0m20:39:06.800740 [info ] [Thread-4 (]: 4 of 30 PASS dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid . [[32mPASS[0m in 2.34s]
[0m20:39:06.803473 [info ] [Thread-1 (]: 1 of 30 PASS accepted_values_customers_customer_type__new__returning ........... [[32mPASS[0m in 2.34s]
[0m20:39:06.805222 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:06.806026 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:06.806504 [debug] [Thread-4 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:06.807416 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:06.807933 [info ] [Thread-4 (]: 5 of 30 START test dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal  [RUN]
[0m20:39:06.808453 [info ] [Thread-1 (]: 6 of 30 START test not_null_customers_customer_id .............................. [RUN]
[0m20:39:06.809079 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92, now test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc)
[0m20:39:06.809573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m20:39:06.810009 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:06.810410 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:06.815921 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc"
[0m20:39:06.822777 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:39:06.823615 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:06.826159 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc"
[0m20:39:06.826506 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:06.828858 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:39:06.829545 [debug] [Thread-4 (]: On test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from `uku-project-437620`.`ds1`.`stg_orders`

where not(order_total - tax_paid = subtotal)


      
    ) dbt_internal_test
[0m20:39:06.829932 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `uku-project-437620`.`ds1`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m20:39:06.830283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:06.830570 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:06.974330 [info ] [Thread-2 (]: 2 of 30 PASS dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend  [[32mPASS[0m in 2.51s]
[0m20:39:06.975184 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:06.975672 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:06.976086 [info ] [Thread-2 (]: 7 of 30 START test not_null_order_items_order_item_id .......................... [RUN]
[0m20:39:06.976585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6, now test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd)
[0m20:39:06.977078 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:06.982175 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd"
[0m20:39:06.983035 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:06.986381 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd"
[0m20:39:06.987039 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from `uku-project-437620`.`ds1`.`order_items`
where order_item_id is null



      
    ) dbt_internal_test
[0m20:39:06.987404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:06.989402 [info ] [Thread-3 (]: 3 of 30 PASS dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal . [[32mPASS[0m in 2.53s]
[0m20:39:06.990046 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:06.990621 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:06.990961 [info ] [Thread-3 (]: 8 of 30 START test not_null_orders_order_id .................................... [RUN]
[0m20:39:06.991311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec, now test.jaffle_shop.not_null_orders_order_id.cf6c17daed)
[0m20:39:06.991654 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:06.995307 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:39:06.995892 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:06.998111 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:39:06.998608 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `uku-project-437620`.`ds1`.`orders`
where order_id is null



      
    ) dbt_internal_test
[0m20:39:06.998919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:07.431672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:77a26f76-79b9-4b73-acaf-78b95d31e03b&page=queryresults
[0m20:39:07.464394 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:0e639280-45c0-4aa0-ae1d-2c1ef6cc4353&page=queryresults
[0m20:39:07.533253 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:9a619469-2407-4089-96d9-02c81c6066f9&page=queryresults
[0m20:39:07.923223 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:23f72c3b-5ff5-4933-a48b-31e7da51bbb4&page=queryresults
[0m20:39:07.974408 [info ] [Thread-1 (]: 6 of 30 PASS not_null_customers_customer_id .................................... [[32mPASS[0m in 1.16s]
[0m20:39:07.976945 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:07.978026 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:07.978992 [info ] [Thread-1 (]: 9 of 30 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m20:39:07.980015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:39:07.980742 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:07.988551 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:39:07.990268 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:07.995522 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:39:07.996366 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `uku-project-437620`.`ds1`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m20:39:07.996826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:08.007022 [info ] [Thread-4 (]: 5 of 30 PASS dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal  [[32mPASS[0m in 1.20s]
[0m20:39:08.007688 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:08.008082 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:08.008491 [info ] [Thread-4 (]: 10 of 30 START test not_null_stg_locations_location_id ......................... [RUN]
[0m20:39:08.008903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc, now test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2)
[0m20:39:08.009248 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:08.013480 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2"
[0m20:39:08.014323 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:08.016754 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2"
[0m20:39:08.017365 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_id
from `uku-project-437620`.`ds1`.`stg_locations`
where location_id is null



      
    ) dbt_internal_test
[0m20:39:08.017716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:08.050527 [info ] [Thread-3 (]: 8 of 30 PASS not_null_orders_order_id .......................................... [[32mPASS[0m in 1.06s]
[0m20:39:08.051069 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:08.051367 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:08.051733 [info ] [Thread-3 (]: 11 of 30 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m20:39:08.052108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_order_id.cf6c17daed, now test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96)
[0m20:39:08.052404 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:08.055706 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96"
[0m20:39:08.056315 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:08.058595 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96"
[0m20:39:08.059166 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `uku-project-437620`.`ds1`.`stg_order_items`
where order_id is null



      
    ) dbt_internal_test
[0m20:39:08.059479 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:08.604022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:8d95f5f9-d585-4065-9a1a-88398889eceb&page=queryresults
[0m20:39:08.629270 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:918bb8d2-539f-4b5a-a378-5fb2602b38c4&page=queryresults
[0m20:39:08.704241 [info ] [Thread-2 (]: 7 of 30 PASS not_null_order_items_order_item_id ................................ [[32mPASS[0m in 1.73s]
[0m20:39:08.705780 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:08.706316 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:08.706751 [info ] [Thread-2 (]: 12 of 30 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m20:39:08.707243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd, now test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:39:08.707968 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:08.715569 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:39:08.716862 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:08.720442 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:39:08.721230 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from `uku-project-437620`.`ds1`.`stg_order_items`
where order_item_id is null



      
    ) dbt_internal_test
[0m20:39:08.721733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:08.790112 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:9e2cee9a-62e7-444c-89a6-2c67b0d29751&page=queryresults
[0m20:39:09.103915 [info ] [Thread-1 (]: 9 of 30 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 1.12s]
[0m20:39:09.105783 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:09.106727 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:09.107568 [info ] [Thread-1 (]: 13 of 30 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:39:09.108569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:39:09.109188 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:09.117059 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:39:09.118282 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:09.121832 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:39:09.122629 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from `uku-project-437620`.`ds1`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m20:39:09.123120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:09.133505 [info ] [Thread-4 (]: 10 of 30 PASS not_null_stg_locations_location_id ............................... [[32mPASS[0m in 1.12s]
[0m20:39:09.135870 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:09.136397 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:09.136850 [info ] [Thread-4 (]: 14 of 30 START test not_null_stg_products_product_id ........................... [RUN]
[0m20:39:09.137433 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2, now test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3)
[0m20:39:09.137792 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:09.142505 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3"
[0m20:39:09.143456 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:09.146112 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3"
[0m20:39:09.146882 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `uku-project-437620`.`ds1`.`stg_products`
where product_id is null



      
    ) dbt_internal_test
[0m20:39:09.147209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:09.319174 [info ] [Thread-3 (]: 11 of 30 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 1.27s]
[0m20:39:09.320345 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:09.320857 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:09.321519 [info ] [Thread-3 (]: 15 of 30 START test not_null_stg_supplies_supply_uuid .......................... [RUN]
[0m20:39:09.322336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96, now test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d)
[0m20:39:09.322863 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:09.328613 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d"
[0m20:39:09.329499 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:09.332831 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d"
[0m20:39:09.333853 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supply_uuid
from `uku-project-437620`.`ds1`.`stg_supplies`
where supply_uuid is null



      
    ) dbt_internal_test
[0m20:39:09.334276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:09.494114 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:f746c225-3108-456e-9948-c7c8510befcc&page=queryresults
[0m20:39:09.737574 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:95893574-4c6c-409f-b414-8b9703c41ba4&page=queryresults
[0m20:39:09.759319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:72cce4ba-78e2-46d9-9833-46105b190370&page=queryresults
[0m20:39:09.991411 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:a84d3849-b0b8-487c-8717-d7dacf19d2e1&page=queryresults
[0m20:39:10.027855 [info ] [Thread-2 (]: 12 of 30 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 1.32s]
[0m20:39:10.029131 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:10.029945 [debug] [Thread-2 (]: Began running node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:10.030831 [info ] [Thread-2 (]: 16 of 30 START test relationships_order_items_order_id__order_id__ref_orders_ .. [RUN]
[0m20:39:10.031769 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8)
[0m20:39:10.032501 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:10.046748 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8"
[0m20:39:10.047719 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:10.051045 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8"
[0m20:39:10.051786 [debug] [Thread-2 (]: On test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `uku-project-437620`.`ds1`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `uku-project-437620`.`ds1`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:39:10.052253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:10.346727 [info ] [Thread-4 (]: 14 of 30 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 1.21s]
[0m20:39:10.348087 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:10.348841 [debug] [Thread-4 (]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:10.349683 [info ] [Thread-4 (]: 17 of 30 START test relationships_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m20:39:10.350513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3, now test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16)
[0m20:39:10.351083 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:10.359804 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16"
[0m20:39:10.360879 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:10.364197 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16"
[0m20:39:10.364985 [debug] [Thread-4 (]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `uku-project-437620`.`ds1`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `uku-project-437620`.`ds1`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:39:10.365478 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:10.375313 [info ] [Thread-1 (]: 13 of 30 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 1.27s]
[0m20:39:10.375930 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:10.376311 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:10.376732 [info ] [Thread-1 (]: 18 of 30 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m20:39:10.377200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:39:10.377581 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:10.383078 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:39:10.383753 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:10.386387 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:39:10.387076 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from `uku-project-437620`.`ds1`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `uku-project-437620`.`ds1`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:39:10.387423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:10.640487 [info ] [Thread-3 (]: 15 of 30 PASS not_null_stg_supplies_supply_uuid ................................ [[32mPASS[0m in 1.32s]
[0m20:39:10.641992 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:10.642752 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:10.643597 [info ] [Thread-3 (]: 19 of 30 START test unique_customers_customer_id ............................... [RUN]
[0m20:39:10.644462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m20:39:10.645065 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:10.654989 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:39:10.656249 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:10.659475 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:39:10.660359 [debug] [Thread-3 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `uku-project-437620`.`ds1`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:10.660845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:10.907393 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:9a4293c1-ee20-4a46-a794-6b0313c9134d&page=queryresults
[0m20:39:11.270308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:5e317fc4-05c0-4286-8830-007aba1215e2&page=queryresults
[0m20:39:11.288382 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:10c15d57-69ad-4bd9-b987-a65a6f80b43a&page=queryresults
[0m20:39:11.376046 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:2e27eb9e-8671-4544-b24d-6fa781b224d3&page=queryresults
[0m20:39:11.648747 [info ] [Thread-2 (]: 16 of 30 PASS relationships_order_items_order_id__order_id__ref_orders_ ........ [[32mPASS[0m in 1.62s]
[0m20:39:11.649812 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:11.650558 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:11.651492 [info ] [Thread-2 (]: 20 of 30 START test unique_order_items_order_item_id ........................... [RUN]
[0m20:39:11.652085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8, now test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a)
[0m20:39:11.652730 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:11.659778 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a"
[0m20:39:11.662605 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:11.665457 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a"
[0m20:39:11.666546 [debug] [Thread-2 (]: On test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `uku-project-437620`.`ds1`.`order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:11.667035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:11.912292 [info ] [Thread-1 (]: 18 of 30 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 1.53s]
[0m20:39:11.914375 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:11.915033 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:11.915609 [info ] [Thread-1 (]: 21 of 30 START test unique_orders_order_id ..................................... [RUN]
[0m20:39:11.916385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.jaffle_shop.unique_orders_order_id.fed79b3a6e)
[0m20:39:11.917009 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:11.923831 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:39:11.925057 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:11.928323 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:39:11.929228 [debug] [Thread-1 (]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `uku-project-437620`.`ds1`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:11.929739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:11.939056 [info ] [Thread-4 (]: 17 of 30 PASS relationships_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 1.59s]
[0m20:39:11.939657 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:11.940041 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:11.940451 [info ] [Thread-4 (]: 22 of 30 START test unique_stg_customers_customer_id ........................... [RUN]
[0m20:39:11.940899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m20:39:11.941250 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:11.945011 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:39:11.945617 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:11.948935 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:39:11.949698 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `uku-project-437620`.`ds1`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:11.950049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:12.069461 [info ] [Thread-3 (]: 19 of 30 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 1.43s]
[0m20:39:12.070256 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:12.070698 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:12.071190 [info ] [Thread-3 (]: 23 of 30 START test unique_stg_locations_location_id ........................... [RUN]
[0m20:39:12.071715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc)
[0m20:39:12.072131 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:12.076810 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc"
[0m20:39:12.077549 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:12.080291 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc"
[0m20:39:12.080935 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `uku-project-437620`.`ds1`.`stg_locations`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:12.081325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:12.760147 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:484e39d8-f9eb-46cb-8ee1-1c4fdfd8083b&page=queryresults
[0m20:39:12.778358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:76b3fadd-55c7-4eae-bdf4-ee549c86375e&page=queryresults
[0m20:39:12.883002 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:6fd65dbe-7ccb-4efe-8442-a2135ec27e46&page=queryresults
[0m20:39:12.902099 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:711dae41-f439-4a22-935c-c03332f72729&page=queryresults
[0m20:39:13.337065 [info ] [Thread-1 (]: 21 of 30 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 1.42s]
[0m20:39:13.338504 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:13.339253 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:13.340112 [info ] [Thread-1 (]: 24 of 30 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m20:39:13.341032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_orders_order_id.fed79b3a6e, now test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108)
[0m20:39:13.341652 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:13.348845 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108"
[0m20:39:13.349982 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:13.354726 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108"
[0m20:39:13.355534 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_item_id as unique_field
  from `uku-project-437620`.`ds1`.`stg_order_items`
  where order_item_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:13.356014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:13.376899 [info ] [Thread-2 (]: 20 of 30 PASS unique_order_items_order_item_id ................................. [[32mPASS[0m in 1.72s]
[0m20:39:13.377467 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:13.377786 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:13.378129 [info ] [Thread-2 (]: 25 of 30 START test unique_stg_orders_order_id ................................. [RUN]
[0m20:39:13.378493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:39:13.378783 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:13.382613 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:39:13.383304 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:13.385552 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:39:13.386075 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `uku-project-437620`.`ds1`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:13.386401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:13.410231 [info ] [Thread-4 (]: 22 of 30 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 1.47s]
[0m20:39:13.410732 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:13.411014 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:13.411303 [info ] [Thread-4 (]: 26 of 30 START test unique_stg_products_product_id ............................. [RUN]
[0m20:39:13.411606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_products_product_id.7d950a1467)
[0m20:39:13.411853 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:13.414990 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_products_product_id.7d950a1467"
[0m20:39:13.415602 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:13.418184 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_products_product_id.7d950a1467"
[0m20:39:13.418631 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `uku-project-437620`.`ds1`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:13.418910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:13.423247 [info ] [Thread-3 (]: 23 of 30 PASS unique_stg_locations_location_id ................................. [[32mPASS[0m in 1.35s]
[0m20:39:13.423681 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:13.424071 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:13.424400 [info ] [Thread-3 (]: 27 of 30 START test unique_stg_supplies_supply_uuid ............................ [RUN]
[0m20:39:13.424731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc, now test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed)
[0m20:39:13.424962 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:13.427983 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed"
[0m20:39:13.428514 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:13.430255 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed"
[0m20:39:13.430649 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select supply_uuid as unique_field
  from `uku-project-437620`.`ds1`.`stg_supplies`
  where supply_uuid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:13.430909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:14.166252 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:e3fabc02-7ed2-4495-ac3e-fb79f9a0e381&page=queryresults
[0m20:39:14.215964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:b848d5ca-72c5-4234-a33c-2b3761d42d06&page=queryresults
[0m20:39:14.259734 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:68301fa1-9318-4a5d-9024-a2c9bef41bc2&page=queryresults
[0m20:39:14.734146 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:a879153f-a038-47ba-8331-657593357280&page=queryresults
[0m20:39:14.783775 [info ] [Thread-3 (]: 27 of 30 PASS unique_stg_supplies_supply_uuid .................................. [[32mPASS[0m in 1.36s]
[0m20:39:14.785076 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:14.785855 [debug] [Thread-3 (]: Began running node unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly
[0m20:39:14.786709 [info ] [Thread-3 (]: 28 of 30 START unit_test order_items::test_supply_costs_sum_correctly .......... [RUN]
[0m20:39:14.787659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed, now unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly)
[0m20:39:14.788357 [debug] [Thread-3 (]: Began compiling node unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly
[0m20:39:14.788980 [debug] [Thread-3 (]: Began executing node unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly
[0m20:39:14.886377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:14.887012 [info ] [Thread-2 (]: 25 of 30 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.51s]
[0m20:39:14.887377 [info ] [Thread-1 (]: 24 of 30 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 1.55s]
[0m20:39:14.888183 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:14.888491 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:14.888780 [debug] [Thread-2 (]: Began running node unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly
[0m20:39:14.889028 [debug] [Thread-1 (]: Began running node unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date
[0m20:39:14.889328 [info ] [Thread-2 (]: 29 of 30 START unit_test orders::test_order_items_compute_to_bools_correctly ... [RUN]
[0m20:39:14.889563 [info ] [Thread-1 (]: 30 of 30 START unit_test stg_locations::test_does_location_opened_at_trunc_to_date  [RUN]
[0m20:39:14.889957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly)
[0m20:39:14.890214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108, now unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date)
[0m20:39:14.890747 [debug] [Thread-2 (]: Began compiling node unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly
[0m20:39:14.890962 [debug] [Thread-1 (]: Began compiling node unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date
[0m20:39:14.891180 [debug] [Thread-2 (]: Began executing node unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly
[0m20:39:14.891381 [debug] [Thread-1 (]: Began executing node unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date
[0m20:39:14.896439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:14.909534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:15.190867 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"
[0m20:39:15.197442 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date"
[0m20:39:15.205463 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date"
[0m20:39:15.207852 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:15.239484 [debug] [Thread-1 (]: On unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date"} */

    
  
    

    create or replace table `uku-project-437620`.`ds1`.`test_does_location_opened_at_trunc_to_date__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        with

 __dbt__cte__raw_stores as (

-- Fixture for raw_stores
select safe_cast(1 as STRING) as id, safe_cast('''Vice City''' as STRING) as name, safe_cast('''2016-09-01T00:00:00''' as DATETIME) as opened_at, safe_cast(0.2 as FLOAT64) as tax_rate
union all
select safe_cast(2 as STRING) as id, safe_cast('''San Andreas''' as STRING) as name, safe_cast('''2079-10-27T23:59:59.9999''' as DATETIME) as opened_at, safe_cast(0.1 as FLOAT64) as tax_rate
), source as (

    select * from __dbt__cte__raw_stores

),

renamed as (

    select

        ----------  ids
        id as location_id,

        ---------- text
        name as location_name,

        ---------- numerics
        tax_rate,

        ---------- timestamps
        timestamp_trunc(
        cast(opened_at as timestamp),
        day
    ) as opened_date

    from source

)

select * from renamed
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    );
  
  
[0m20:39:15.360437 [info ] [Thread-4 (]: 26 of 30 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 1.95s]
[0m20:39:15.361319 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:15.394832 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"
[0m20:39:15.404645 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"
[0m20:39:15.407763 [debug] [Thread-2 (]: On unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"} */

    
  
    

    create or replace table `uku-project-437620`.`ds1`.`test_order_items_compute_to_bools_correctly__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        with

 __dbt__cte__stg_orders as (

-- Fixture for stg_orders
select safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
union all
select safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
),  __dbt__cte__order_items as (

-- Fixture for order_items
select safe_cast(1 as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(True as BOOLEAN) as is_food_item, safe_cast(False as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
union all
select safe_cast(2 as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(False as BOOLEAN) as is_food_item, safe_cast(True as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
union all
select safe_cast(3 as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(True as BOOLEAN) as is_food_item, safe_cast(False as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
), orders as (

    select * from __dbt__cte__stg_orders

),

order_items as (

    select * from __dbt__cte__order_items

),

order_items_summary as (

    select
        order_id,

        sum(supply_cost) as order_cost,
        sum(product_price) as order_items_subtotal,
        count(order_item_id) as count_order_items,
        sum(
            case
                when is_food_item then 1
                else 0
            end
        ) as count_food_items,
        sum(
            case
                when is_drink_item then 1
                else 0
            end
        ) as count_drink_items

    from order_items

    group by 1

),

compute_booleans as (

    select
        orders.*,

        order_items_summary.order_cost,
        order_items_summary.order_items_subtotal,
        order_items_summary.count_food_items,
        order_items_summary.count_drink_items,
        order_items_summary.count_order_items,
        order_items_summary.count_food_items > 0 as is_food_order,
        order_items_summary.count_drink_items > 0 as is_drink_order

    from orders

    left join
        order_items_summary
        on orders.order_id = order_items_summary.order_id

),

customer_order_count as (

    select
        *,

        row_number() over (
            partition by customer_id
            order by ordered_at asc
        ) as customer_order_number

    from compute_booleans

)

select * from customer_order_count
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    );
  
  
[0m20:39:15.410513 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:15.754799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:b0b28c8f-fbc3-45f5-a565-55c473494b22&page=queryresults
[0m20:39:15.928470 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:16.191445 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:898e0cf8-c40f-45f7-8e5e-7036858b3ca9&page=queryresults
[0m20:39:16.198154 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:16.209666 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:16.216470 [debug] [Thread-3 (]: On unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"} */

    
  
    

    create or replace table `uku-project-437620`.`ds1`.`test_supply_costs_sum_correctly__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        with

 __dbt__cte__stg_order_items as (

-- Fixture for stg_order_items
select safe_cast(null as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(1 as STRING) as product_id
union all
select safe_cast(null as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id
union all
select safe_cast(null as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id
),  __dbt__cte__stg_orders as (

-- Fixture for stg_orders
select safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
union all
select safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
),  __dbt__cte__stg_products as (

-- Fixture for stg_products
select safe_cast(1 as STRING) as product_id, safe_cast(null as STRING) as product_name, safe_cast(null as STRING) as product_type, safe_cast(null as STRING) as product_description, safe_cast(null as NUMERIC) as product_price, safe_cast(null as BOOLEAN) as is_food_item, safe_cast(null as BOOLEAN) as is_drink_item
union all
select safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as product_name, safe_cast(null as STRING) as product_type, safe_cast(null as STRING) as product_description, safe_cast(null as NUMERIC) as product_price, safe_cast(null as BOOLEAN) as is_food_item, safe_cast(null as BOOLEAN) as is_drink_item
),  __dbt__cte__stg_supplies as (

-- Fixture for stg_supplies
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(1 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(4.5 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
union all
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(3.5 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
union all
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(5.0 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
), order_items as (

    select * from __dbt__cte__stg_order_items

),


orders as (

    select * from __dbt__cte__stg_orders

),

products as (

    select * from __dbt__cte__stg_products

),

supplies as (

    select * from __dbt__cte__stg_supplies

),

order_supplies_summary as (

    select
        product_id,

        sum(supply_cost) as supply_cost

    from supplies

    group by 1

),

joined as (

    select
        order_items.*,

        orders.ordered_at,

        products.product_name,
        products.product_price,
        products.is_food_item,
        products.is_drink_item,

        order_supplies_summary.supply_cost

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    );
  
  
[0m20:39:16.711667 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:1f3e062c-3d01-4713-af64-b82208b2a026&page=queryresults
[0m20:39:18.218349 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date"
[0m20:39:18.222530 [debug] [Thread-1 (]: On unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    location_id,location_name,tax_rate,opened_date, '''actual''' as `actual_or_expected`
  from (
    with

 __dbt__cte__raw_stores as (

-- Fixture for raw_stores
select safe_cast(1 as STRING) as id, safe_cast('''Vice City''' as STRING) as name, safe_cast('''2016-09-01T00:00:00''' as DATETIME) as opened_at, safe_cast(0.2 as FLOAT64) as tax_rate
union all
select safe_cast(2 as STRING) as id, safe_cast('''San Andreas''' as STRING) as name, safe_cast('''2079-10-27T23:59:59.9999''' as DATETIME) as opened_at, safe_cast(0.1 as FLOAT64) as tax_rate
), source as (

    select * from __dbt__cte__raw_stores

),

renamed as (

    select

        ----------  ids
        id as location_id,

        ---------- text
        name as location_name,

        ---------- numerics
        tax_rate,

        ---------- timestamps
        timestamp_trunc(
        cast(opened_at as timestamp),
        day
    ) as opened_date

    from source

)

select * from renamed
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    location_id, location_name, tax_rate, opened_date, '''expected''' as `actual_or_expected`
  from (
    select safe_cast(1 as STRING) as location_id, safe_cast('''Vice City''' as STRING) as location_name, safe_cast(0.2 as FLOAT64) as tax_rate, safe_cast('''2016-09-01''' as TIMESTAMP) as opened_date
union all
select safe_cast(2 as STRING) as location_id, safe_cast('''San Andreas''' as STRING) as location_name, safe_cast(0.1 as FLOAT64) as tax_rate, safe_cast('''2079-10-27''' as TIMESTAMP) as opened_date
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m20:39:18.364388 [debug] [Thread-2 (]: Writing runtime sql for node "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"
[0m20:39:18.366818 [debug] [Thread-2 (]: On unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    order_id,count_food_items,count_drink_items,is_drink_order,is_food_order, '''actual''' as `actual_or_expected`
  from (
    with

 __dbt__cte__stg_orders as (

-- Fixture for stg_orders
select safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
union all
select safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
),  __dbt__cte__order_items as (

-- Fixture for order_items
select safe_cast(1 as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(True as BOOLEAN) as is_food_item, safe_cast(False as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
union all
select safe_cast(2 as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(False as BOOLEAN) as is_food_item, safe_cast(True as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
union all
select safe_cast(3 as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as product_id, safe_cast(null as TIMESTAMP) as ordered_at, safe_cast(null as STRING) as product_name, safe_cast(null as NUMERIC) as product_price, safe_cast(True as BOOLEAN) as is_food_item, safe_cast(False as BOOLEAN) as is_drink_item, safe_cast(null as NUMERIC) as supply_cost
), orders as (

    select * from __dbt__cte__stg_orders

),

order_items as (

    select * from __dbt__cte__order_items

),

order_items_summary as (

    select
        order_id,

        sum(supply_cost) as order_cost,
        sum(product_price) as order_items_subtotal,
        count(order_item_id) as count_order_items,
        sum(
            case
                when is_food_item then 1
                else 0
            end
        ) as count_food_items,
        sum(
            case
                when is_drink_item then 1
                else 0
            end
        ) as count_drink_items

    from order_items

    group by 1

),

compute_booleans as (

    select
        orders.*,

        order_items_summary.order_cost,
        order_items_summary.order_items_subtotal,
        order_items_summary.count_food_items,
        order_items_summary.count_drink_items,
        order_items_summary.count_order_items,
        order_items_summary.count_food_items > 0 as is_food_order,
        order_items_summary.count_drink_items > 0 as is_drink_order

    from orders

    left join
        order_items_summary
        on orders.order_id = order_items_summary.order_id

),

customer_order_count as (

    select
        *,

        row_number() over (
            partition by customer_id
            order by ordered_at asc
        ) as customer_order_number

    from compute_booleans

)

select * from customer_order_count
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    order_id, count_food_items, count_drink_items, is_drink_order, is_food_order, '''expected''' as `actual_or_expected`
  from (
    select safe_cast(1 as STRING) as order_id, safe_cast(1 as INT64) as count_food_items, safe_cast(1 as INT64) as count_drink_items, safe_cast(True as BOOLEAN) as is_drink_order, safe_cast(True as BOOLEAN) as is_food_order
union all
select safe_cast(2 as STRING) as order_id, safe_cast(1 as INT64) as count_food_items, safe_cast(0 as INT64) as count_drink_items, safe_cast(False as BOOLEAN) as is_drink_order, safe_cast(True as BOOLEAN) as is_food_order
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m20:39:18.562997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:b8f06017-d8d1-43c5-a6ee-7bf957910aa5&page=queryresults
[0m20:39:18.718276 [debug] [Thread-3 (]: Writing runtime sql for node "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"
[0m20:39:18.722423 [debug] [Thread-3 (]: On unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    order_id,product_id,supply_cost, '''actual''' as `actual_or_expected`
  from (
    with

 __dbt__cte__stg_order_items as (

-- Fixture for stg_order_items
select safe_cast(null as STRING) as order_item_id, safe_cast(1 as STRING) as order_id, safe_cast(1 as STRING) as product_id
union all
select safe_cast(null as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id
union all
select safe_cast(null as STRING) as order_item_id, safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id
),  __dbt__cte__stg_orders as (

-- Fixture for stg_orders
select safe_cast(1 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
union all
select safe_cast(2 as STRING) as order_id, safe_cast(null as STRING) as location_id, safe_cast(null as STRING) as customer_id, safe_cast(null as INT64) as subtotal_cents, safe_cast(null as INT64) as tax_paid_cents, safe_cast(null as INT64) as order_total_cents, safe_cast(null as NUMERIC) as subtotal, safe_cast(null as NUMERIC) as tax_paid, safe_cast(null as NUMERIC) as order_total, safe_cast(null as TIMESTAMP) as ordered_at
),  __dbt__cte__stg_products as (

-- Fixture for stg_products
select safe_cast(1 as STRING) as product_id, safe_cast(null as STRING) as product_name, safe_cast(null as STRING) as product_type, safe_cast(null as STRING) as product_description, safe_cast(null as NUMERIC) as product_price, safe_cast(null as BOOLEAN) as is_food_item, safe_cast(null as BOOLEAN) as is_drink_item
union all
select safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as product_name, safe_cast(null as STRING) as product_type, safe_cast(null as STRING) as product_description, safe_cast(null as NUMERIC) as product_price, safe_cast(null as BOOLEAN) as is_food_item, safe_cast(null as BOOLEAN) as is_drink_item
),  __dbt__cte__stg_supplies as (

-- Fixture for stg_supplies
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(1 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(4.5 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
union all
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(3.5 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
union all
select safe_cast(null as STRING) as supply_uuid, safe_cast(null as STRING) as supply_id, safe_cast(2 as STRING) as product_id, safe_cast(null as STRING) as supply_name, safe_cast(5.0 as NUMERIC) as supply_cost, safe_cast(null as BOOLEAN) as is_perishable_supply
), order_items as (

    select * from __dbt__cte__stg_order_items

),


orders as (

    select * from __dbt__cte__stg_orders

),

products as (

    select * from __dbt__cte__stg_products

),

supplies as (

    select * from __dbt__cte__stg_supplies

),

order_supplies_summary as (

    select
        product_id,

        sum(supply_cost) as supply_cost

    from supplies

    group by 1

),

joined as (

    select
        order_items.*,

        orders.ordered_at,

        products.product_name,
        products.product_price,
        products.is_food_item,
        products.is_drink_item,

        order_supplies_summary.supply_cost

    from order_items

    left join orders on order_items.order_id = orders.order_id

    left join products on order_items.product_id = products.product_id

    left join order_supplies_summary
        on order_items.product_id = order_supplies_summary.product_id

)

select * from joined
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    order_id, product_id, supply_cost, '''expected''' as `actual_or_expected`
  from (
    select safe_cast(1 as STRING) as order_id, safe_cast(1 as STRING) as product_id, safe_cast(4.5 as NUMERIC) as supply_cost
union all
select safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id, safe_cast(8.5 as NUMERIC) as supply_cost
union all
select safe_cast(2 as STRING) as order_id, safe_cast(2 as STRING) as product_id, safe_cast(8.5 as NUMERIC) as supply_cost
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m20:39:18.940183 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:4377b936-5d94-4359-8a18-2b0b04b072ce&page=queryresults
[0m20:39:19.224306 [info ] [Thread-1 (]: 30 of 30 PASS stg_locations::test_does_location_opened_at_trunc_to_date ........ [[32mPASS[0m in 4.33s]
[0m20:39:19.225658 [debug] [Thread-1 (]: Finished running node unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date
[0m20:39:19.451061 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:4f42fe62-1826-41f7-8db2-7f3c30e245cc&page=queryresults
[0m20:39:19.642139 [info ] [Thread-2 (]: 29 of 30 PASS orders::test_order_items_compute_to_bools_correctly .............. [[32mPASS[0m in 4.75s]
[0m20:39:19.643130 [debug] [Thread-2 (]: Finished running node unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly
[0m20:39:20.318556 [info ] [Thread-3 (]: 28 of 30 PASS order_items::test_supply_costs_sum_correctly ..................... [[32mPASS[0m in 5.53s]
[0m20:39:20.319874 [debug] [Thread-3 (]: Finished running node unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly
[0m20:39:20.321891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:20.322982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:20.323737 [debug] [MainThread]: Connection 'unit_test.jaffle_shop.stg_locations.test_does_location_opened_at_trunc_to_date' was properly closed.
[0m20:39:20.324247 [debug] [MainThread]: Connection 'unit_test.jaffle_shop.orders.test_order_items_compute_to_bools_correctly' was properly closed.
[0m20:39:20.324707 [debug] [MainThread]: Connection 'unit_test.jaffle_shop.order_items.test_supply_costs_sum_correctly' was properly closed.
[0m20:39:20.325138 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m20:39:20.325721 [info ] [MainThread]: 
[0m20:39:20.326218 [info ] [MainThread]: Finished running 27 data tests, 3 unit tests in 0 hours 0 minutes and 16.55 seconds (16.55s).
[0m20:39:20.331702 [debug] [MainThread]: Command end result
[0m20:39:20.375155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:39:20.380731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:39:20.386548 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamara/src/jaffle-shop/dbt/target/run_results.json
[0m20:39:20.386830 [info ] [MainThread]: 
[0m20:39:20.387099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:20.387328 [info ] [MainThread]: 
[0m20:39:20.387538 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=0 SKIP=0 TOTAL=30
[0m20:39:20.388730 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.620422, "process_in_blocks": "0", "process_kernel_time": 0.377407, "process_mem_max_rss": "217120768", "process_out_blocks": "0", "process_user_time": 3.076488}
[0m20:39:20.389070 [debug] [MainThread]: Command `dbt test` succeeded at 20:39:20.389018 after 17.62 seconds
[0m20:39:20.389329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ee3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103725210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c61faf0>]}
[0m20:39:20.389582 [debug] [MainThread]: Flushing usage events
[0m20:39:20.684256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:57.495213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032da380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b3340>]}


============================== 20:39:57.497848 | 8d16aeec-441d-4791-a403-f5277448e9dc ==============================
[0m20:39:57.497848 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:39:57.498220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tamara/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:39:57.933156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c3220>]}
[0m20:39:58.008868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104021810>]}
[0m20:39:58.009441 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m20:39:58.121004 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m20:39:58.261617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:58.261952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:58.266068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:39:58.314507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fc0130>]}
[0m20:39:58.330714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f125f0>]}
[0m20:39:58.331067 [info ] [MainThread]: Found 13 models, 27 data tests, 6 sources, 19 metrics, 787 macros, 6 semantic models, 3 saved queries, 3 unit tests
[0m20:39:58.331288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103130a60>]}
[0m20:39:58.333321 [info ] [MainThread]: 
[0m20:39:58.333564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:58.333778 [info ] [MainThread]: 
[0m20:39:58.334081 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:58.337433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uku-project-437620_ds1'
[0m20:39:58.337687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:58.926211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d16aeec-441d-4791-a403-f5277448e9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024324a0>]}
[0m20:39:58.927397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:58.931571 [debug] [Thread-1 (]: Began running node model.jaffle_shop.metricflow_time_spine
[0m20:39:58.932095 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m20:39:58.932630 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_locations
[0m20:39:58.933173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uku-project-437620_ds1, now model.jaffle_shop.metricflow_time_spine)
[0m20:39:58.933609 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_order_items
[0m20:39:58.934215 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_customers'
[0m20:39:58.934783 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_locations'
[0m20:39:58.935262 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.metricflow_time_spine
[0m20:39:58.935796 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.jaffle_shop.stg_order_items'
[0m20:39:58.936222 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:39:58.936633 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_locations
[0m20:39:58.965373 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_order_items
[0m20:39:58.976799 [debug] [Thread-1 (]: On model.jaffle_shop.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.metricflow_time_spine"} */


        select 

    datetime_diff(
        cast(cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval 1 day
        )

 as date) as datetime),
        cast(

        datetime_add(
            cast( cast(timestamp(datetime(current_timestamp(), 'America/Los_Angeles')) as date) as datetime),
        interval -3650 day
        )

 as datetime),
        day
    )

  
[0m20:39:58.979814 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:39:58.983658 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_locations"
[0m20:39:58.985810 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_order_items"
[0m20:39:58.986120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:58.987443 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_locations
[0m20:39:58.987738 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_order_items
[0m20:39:58.987965 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:39:58.988239 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:58.988481 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:39:58.988708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:39:58.989220 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_locations
[0m20:39:58.989860 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_order_items
[0m20:39:58.990546 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:39:58.990799 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m20:39:58.991177 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_products
[0m20:39:58.991567 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_supplies
[0m20:39:58.991906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_locations, now model.jaffle_shop.stg_orders)
[0m20:39:58.992163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_order_items, now model.jaffle_shop.stg_products)
[0m20:39:58.992402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_supplies)
[0m20:39:58.992619 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:39:58.992828 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_products
[0m20:39:58.993033 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_supplies
[0m20:39:58.996900 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:39:58.999091 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_products"
[0m20:39:59.008657 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_supplies"
[0m20:39:59.009188 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:39:59.009440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.009914 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:39:59.010153 [debug] [Thread-3 (]: Began running node model.jaffle_shop.locations
[0m20:39:59.010363 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_products
[0m20:39:59.010572 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_supplies
[0m20:39:59.010903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.locations)
[0m20:39:59.011133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.011359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.011571 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.locations
[0m20:39:59.012008 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_products
[0m20:39:59.012514 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_supplies
[0m20:39:59.014429 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.locations"
[0m20:39:59.014697 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:59.015012 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:59.015370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_products, now test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2)
[0m20:39:59.015626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_supplies, now test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc)
[0m20:39:59.015867 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:59.016066 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.locations
[0m20:39:59.016276 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:59.023113 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2"
[0m20:39:59.023369 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.027461 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc"
[0m20:39:59.028016 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.locations
[0m20:39:59.028335 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:59.028599 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:59.028844 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.locations, now test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96)
[0m20:39:59.029084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.029291 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:59.029502 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:59.030025 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2
[0m20:39:59.030246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.032673 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96"
[0m20:39:59.032933 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:59.033401 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc
[0m20:39:59.033676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_locations_location_id.3d237927d2, now test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m20:39:59.033939 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:59.034182 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:59.034395 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:59.034633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_locations_location_id.2e2fc58ecc, now test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108)
[0m20:39:59.034862 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.037342 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m20:39:59.037582 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:59.038030 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96
[0m20:39:59.040579 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108"
[0m20:39:59.040841 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:59.041247 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:59.041514 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_order_items_order_id.2063801f96, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:39:59.041807 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.042010 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:59.042221 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:59.042673 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m20:39:59.042892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.046046 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:39:59.046312 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:59.046775 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108
[0m20:39:59.047052 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m20:39:59.047328 [debug] [Thread-2 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:59.047575 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:59.047780 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:59.048019 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_order_items_order_item_id.90e333a108, now test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc)
[0m20:39:59.048245 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.050737 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:39:59.050983 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:59.051426 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:39:59.056271 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc"
[0m20:39:59.056549 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:59.056844 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:59.057100 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:39:59.057347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.057578 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:59.057780 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:59.058231 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:39:59.060749 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:39:59.061008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.061254 [debug] [Thread-4 (]: Began running node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:59.061797 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc
[0m20:39:59.062165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m20:39:59.062495 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:59.062708 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:59.062959 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:59.063193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_stg_orders_order_total_tax_paid_subtotal.bfb885d7fc, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:39:59.063423 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.068902 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m20:39:59.069160 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:59.069633 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:39:59.072151 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:39:59.072449 [debug] [Thread-3 (]: Began running node model.jaffle_shop.products
[0m20:39:59.072742 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:59.073005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_shop.products)
[0m20:39:59.073269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.073503 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.products
[0m20:39:59.073700 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:59.074217 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m20:39:59.076075 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.products"
[0m20:39:59.076325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.076563 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:59.077075 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:39:59.077320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3)
[0m20:39:59.077572 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:59.077794 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.products
[0m20:39:59.078015 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:59.078243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_stg_products_product_id.7d950a1467)
[0m20:39:59.078466 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.080942 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3"
[0m20:39:59.081179 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:59.081623 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.products
[0m20:39:59.084117 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_products_product_id.7d950a1467"
[0m20:39:59.084374 [debug] [Thread-3 (]: Began running node model.jaffle_shop.order_items
[0m20:39:59.084657 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:59.084906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.products, now model.jaffle_shop.order_items)
[0m20:39:59.085156 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.085386 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.order_items
[0m20:39:59.085581 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:59.086012 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3
[0m20:39:59.089050 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.order_items"
[0m20:39:59.089301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.089534 [debug] [Thread-4 (]: Began running node model.jaffle_shop.supplies
[0m20:39:59.090043 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_products_product_id.7d950a1467
[0m20:39:59.090332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_products_product_id.6373b0acf3, now model.jaffle_shop.supplies)
[0m20:39:59.090590 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:59.090808 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.order_items
[0m20:39:59.091025 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.supplies
[0m20:39:59.091257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_products_product_id.7d950a1467, now test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d)
[0m20:39:59.091477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.093275 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.supplies"
[0m20:39:59.093501 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:59.093954 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.order_items
[0m20:39:59.096472 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d"
[0m20:39:59.096731 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:59.097114 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.supplies
[0m20:39:59.097370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_items, now test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed)
[0m20:39:59.097611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.097808 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:59.098017 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:59.098450 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.supplies
[0m20:39:59.098663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.101156 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed"
[0m20:39:59.101452 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders
[0m20:39:59.101970 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d
[0m20:39:59.102255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.supplies, now model.jaffle_shop.orders)
[0m20:39:59.102521 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:59.102769 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:59.102973 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders
[0m20:39:59.103210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_supplies_supply_uuid.515c6eda6d, now test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd)
[0m20:39:59.103445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.106396 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m20:39:59.106641 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:59.107143 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed
[0m20:39:59.109637 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd"
[0m20:39:59.109897 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:59.110191 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders
[0m20:39:59.110444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_supplies_supply_uuid.c9e3edcfed, now test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a)
[0m20:39:59.110707 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.110909 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:59.111120 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:59.111634 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders
[0m20:39:59.111856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.114269 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a"
[0m20:39:59.114897 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd
[0m20:39:59.115099 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m20:39:59.115380 [debug] [Thread-2 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:59.115713 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.orders, now model.jaffle_shop.customers)
[0m20:39:59.115923 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:59.116160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_order_items_order_item_id.c6fda366bd, now test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec)
[0m20:39:59.116388 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m20:39:59.116610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.116823 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:59.118926 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:39:59.119406 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a
[0m20:39:59.123038 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec"
[0m20:39:59.123350 [debug] [Thread-3 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:59.123646 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m20:39:59.123871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_order_items_order_item_id.7d0a7e900a, now test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92)
[0m20:39:59.124132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.124333 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:59.124550 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:59.124996 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m20:39:59.125214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.128177 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92"
[0m20:39:59.128443 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:59.128982 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec
[0m20:39:59.129267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customers, now test.jaffle_shop.not_null_orders_order_id.cf6c17daed)
[0m20:39:59.129539 [debug] [Thread-2 (]: Began running node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:59.129767 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:59.129984 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:59.130214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_orders_order_items_subtotal_subtotal.b1416e07ec, now test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8)
[0m20:39:59.130445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.132966 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m20:39:59.133215 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:59.133682 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92
[0m20:39:59.136725 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8"
[0m20:39:59.137021 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:59.137259 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:59.137554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.dbt_utils_expression_is_true_orders_order_total_subtotal_tax_paid.2aba85df92, now test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16)
[0m20:39:59.137815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.138047 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:59.138250 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:59.138705 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m20:39:59.142846 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16"
[0m20:39:59.143114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.143358 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:59.143879 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8
[0m20:39:59.144116 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_order_id.cf6c17daed, now test.jaffle_shop.unique_orders_order_id.fed79b3a6e)
[0m20:39:59.144376 [debug] [Thread-2 (]: Began running node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:59.144604 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:59.144824 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:59.145066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_order_items_order_id__order_id__ref_orders_.a799023ee8, now test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8)
[0m20:39:59.145310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.147749 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m20:39:59.148002 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:59.148509 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16
[0m20:39:59.153605 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8"
[0m20:39:59.153903 [debug] [Thread-3 (]: Began running node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:59.154193 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:59.154493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_stg_customers_.918495ce16, now test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6)
[0m20:39:59.154753 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.154993 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:59.155199 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:59.155647 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m20:39:59.158687 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6"
[0m20:39:59.158950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.159193 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:59.159726 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8
[0m20:39:59.159975 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_orders_order_id.fed79b3a6e, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m20:39:59.160238 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:59.160475 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:59.160695 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:59.160924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_customers_customer_type__new__returning.d12f0947c8, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m20:39:59.161152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:59.163652 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:39:59.163892 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:59.165201 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6
[0m20:39:59.216456 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:39:59.216970 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:59.217235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:39:59.217748 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:39:59.218034 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:59.218241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:59.218712 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:39:59.715537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:5d797f4c-ec27-466b-9b1d-35c95607482a&page=queryresults
[0m20:40:00.842015 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.metricflow_time_spine"
[0m20:40:00.843445 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.metricflow_time_spine
[0m20:40:00.844653 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.metricflow_time_spine
[0m20:40:00.846010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:00.846418 [debug] [MainThread]: Connection 'model.jaffle_shop.metricflow_time_spine' was properly closed.
[0m20:40:00.846716 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m20:40:00.847017 [debug] [MainThread]: Connection 'test.jaffle_shop.dbt_utils_expression_is_true_customers_lifetime_spend_pretax_lifetime_tax_paid_lifetime_spend.ad37c989b6' was properly closed.
[0m20:40:00.847314 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m20:40:00.852100 [debug] [MainThread]: Command end result
[0m20:40:00.974834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:40:00.980614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:40:00.985469 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamara/src/jaffle-shop/dbt/target/run_results.json
[0m20:40:00.987230 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m20:40:00.987453 [info ] [MainThread]: Building catalog
[0m20:40:00.992245 [debug] [ThreadPool]: Acquiring new bigquery connection 'uku-project-437620.information_schema'
[0m20:40:00.992722 [debug] [ThreadPool]: Acquiring new bigquery connection 'uku-project-437620.information_schema'
[0m20:40:01.001817 [debug] [ThreadPool]: On uku-project-437620.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "uku-project-437620.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `uku-project-437620`.`ds1`.__TABLES__ tables
    left join `uku-project-437620`.`ds1`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `uku-project-437620`.`ds1`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('products')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('supplies')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_order_items')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_supplies')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('metricflow_time_spine')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('locations')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('customers')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('orders')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_locations')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_customers')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('order_items')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('ds1')
                            and upper(table_name) = upper('stg_products')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `uku-project-437620`.`ds1`.INFORMATION_SCHEMA.COLUMNS columns
    join `uku-project-437620`.`ds1`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m20:40:01.004074 [debug] [ThreadPool]: On uku-project-437620.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "uku-project-437620.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `uku-project-437620`.`raw`.__TABLES__ tables
    left join `uku-project-437620`.`raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `uku-project-437620`.`raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_orders')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_customers')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_products')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_stores')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_items')
                            ) or (
                                upper(table_schema) = upper('raw')
                            and upper(table_name) = upper('raw_supplies')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `uku-project-437620`.`raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `uku-project-437620`.`raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m20:40:01.004616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:01.004863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:01.454536 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:8bfcaac3-5989-480b-b27f-239779417c14&page=queryresults
[0m20:40:01.456307 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uku-project-437620&j=bq:US:906323df-f940-4237-b287-ff5f84d457b1&page=queryresults
[0m20:40:03.960508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:03.972958 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/tamara/src/jaffle-shop/dbt/target/catalog.json
[0m20:40:04.003372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamara/src/jaffle-shop/dbt/target/manifest.json
[0m20:40:04.007824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamara/src/jaffle-shop/dbt/target/semantic_manifest.json
[0m20:40:04.008066 [info ] [MainThread]: Catalog written to /Users/tamara/src/jaffle-shop/dbt/target/catalog.json
[0m20:40:04.009322 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.558626, "process_in_blocks": "0", "process_kernel_time": 0.275475, "process_mem_max_rss": "208322560", "process_out_blocks": "0", "process_user_time": 2.077206}
[0m20:40:04.009735 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:40:04.009681 after 6.56 seconds
[0m20:40:04.009958 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:40:04.010155 [debug] [MainThread]: Connection 'uku-project-437620.information_schema' was properly closed.
[0m20:40:04.010334 [debug] [MainThread]: Connection 'uku-project-437620.information_schema' was properly closed.
[0m20:40:04.010547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032da380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103131570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104021810>]}
[0m20:40:04.010791 [debug] [MainThread]: Flushing usage events
[0m20:40:04.348613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:17.168225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108876b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088772b0>]}


============================== 20:40:17.171322 | d1bcf8d1-d199-4f74-876d-d65f6066114d ==============================
[0m20:40:17.171322 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:40:17.171690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tamara/src/jaffle-shop/dbt/logs', 'profiles_dir': '/Users/tamara/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:17.618064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1bcf8d1-d199-4f74-876d-d65f6066114d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a53b20>]}
[0m20:40:17.692088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1bcf8d1-d199-4f74-876d-d65f6066114d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a307f0>]}
